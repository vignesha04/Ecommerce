!function(e,t){"use strict";function n(){function n(e,t){return o(e.split(","),t)}function o(e,t){var n,o={};for(n=0;n<e.length;n++)o[t?c(e[n]):e[n]]=!0;return o}function g(e,t){t&&t.length&&r(e,o(t))}function m(e,t){null===e||void 0===e?e="":"string"!=typeof e&&(e=""+e);var n=P(e);if(!n)return"";var o=5;do{if(0===o)throw f("uinput","Failed to sanitize html because the input is unstable");o--,e=n.innerHTML,n=P(e)}while(e!==n.innerHTML);for(var a=n.firstChild;a;){switch(a.nodeType){case 1:t.start(a.nodeName.toLowerCase(),v(a.attributes));break;case 3:t.chars(a.textContent)}var r;if(!(r=a.firstChild)&&(1===a.nodeType&&t.end(a.nodeName.toLowerCase()),r=C("nextSibling",a),!r))for(;null==r&&(a=C("parentNode",a),a!==n);)r=C("nextSibling",a),1===a.nodeType&&t.end(a.nodeName.toLowerCase());a=r}for(;a=n.firstChild;)n.removeChild(a)}function v(e){for(var t={},n=0,o=e.length;o>n;n++){var a=e[n];t[a.name]=a.value}return t}function x(e){return e.replace(/&/g,"&amp;").replace(E,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(B,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function b(e,t){var n=!1,o=a(e,e.push);return{start:function(e,a){e=c(e),!n&&O[e]&&(n=e),n||H[e]!==!0||(o("<"),o(e),i(a,function(n,a){var r=c(a),i="img"===e&&"src"===r||"background"===r;z[r]!==!0||U[r]===!0&&!t(n,i)||(o(" "),o(a),o('="'),o(x(n)),o('"'))}),o(">"))},end:function(e){e=c(e),n||H[e]!==!0||k[e]===!0||(o("</"),o(e),o(">")),e==n&&(n=!1)},chars:function(e){n||o(x(e))}}}function w(t){for(;t;){if(t.nodeType===e.Node.ELEMENT_NODE)for(var n=t.attributes,o=0,a=n.length;a>o;o++){var r=n[o],i=r.name.toLowerCase();("xmlns:ns1"===i||0===i.lastIndexOf("ns1:",0))&&(t.removeAttributeNode(r),o--,a--)}var s=t.firstChild;s&&w(s),t=C("nextSibling",t)}}function C(e,t){var n=t[e];if(n&&d.call(t,n))throw f("elclob","Failed to sanitize html because the element is clobbered: {0}",t.outerHTML||t.outerText);return n}var y=!1,$=!1;this.$get=["$$sanitizeUri",function(e){return y=!0,$&&r(H,j),function(t){var n=[];return h(t,p(n,function(t,n){return!/^unsafe:/.test(e(t,n))})),n.join("")}}],this.enableSvg=function(e){return l(e)?($=e,this):$},this.addValidElements=function(e){return y||(s(e)&&(e={htmlElements:e}),g(j,e.svgElements),g(k,e.htmlVoidElements),g(H,e.htmlVoidElements),g(H,e.htmlElements)),this},this.addValidAttrs=function(e){return y||r(z,o(e,!0)),this},a=t.bind,r=t.extend,i=t.forEach,s=t.isArray,l=t.isDefined,c=t.$$lowercase,u=t.noop,h=m,p=b,d=e.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))};var E=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,B=/([^#-~ |!])/g,k=n("area,br,col,hr,img,wbr"),A=n("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),S=n("rp,rt"),q=r({},S,A),_=r({},A,n("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),T=r({},S,n("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),j=n("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),O=n("script,style"),H=r({},k,_,T,q),U=n("background,cite,href,longdesc,src,xlink:href,xml:base"),I=n("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),R=n("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),z=r({},U,R,I),P=function(e,t){function n(t){t="<remove></remove>"+t;try{t=encodeURI(t)}catch(n){return void 0}var o=new e.XMLHttpRequest;o.responseType="document",o.open("GET","data:text/html;charset=utf-8,"+t,!1),o.send(null);var a=o.response.body;return a.firstChild.remove(),a}function o(t){t="<remove></remove>"+t;try{var n=(new e.DOMParser).parseFromString(t,"text/html").body;return n.firstChild.remove(),n}catch(o){return void 0}}function a(e){return i.innerHTML=e,t.documentMode&&w(i),i}var r;if(!t||!t.implementation)throw f("noinert","Can't create an inert html document");r=t.implementation.createHTMLDocument("inert");var i=(r.documentElement||r.getDocumentElement()).querySelector("body");return i.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',i.querySelector("svg")?(i.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',i.querySelector("svg img")?o:a):n}(e,e.document)}function o(e){var t=[],n=p(t,u);return n.chars(e),t.join("")}var a,r,i,s,l,c,u,d,h,p,f=t.$$minErr("$sanitize");t.module("ngSanitize",[]).provider("$sanitize",n).info({angularVersion:"1.7.8"}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((s?ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,a=/^mailto:/i,r=t.$$minErr("linky"),i=t.isDefined,s=t.isFunction,l=t.isObject,c=t.isString;return function(t,u,d){function h(e){e&&b.push(o(e))}function p(e,t){var n,o=v(e);b.push("<a ");for(n in o)b.push(n+'="'+o[n]+'" ');!i(u)||"target"in o||b.push('target="',u,'" '),b.push('href="',e.replace(/"/g,"&quot;"),'">'),h(t),b.push("</a>")}if(null==t||""===t)return t;if(!c(t))throw r("notstring","Expected string but received: {0}",t);for(var f,g,m,v=s(d)?d:l(d)?function(){return d}:function(){return{}},x=t,b=[];f=x.match(n);)g=f[0],f[2]||f[4]||(g=(f[3]?"http://":"mailto:")+g),m=f.index,h(x.substr(0,m)),p(g,f[0].replace(a,"")),x=x.substring(m+f[0].length);return h(x),e(b.join(""))}}]),describe("ngBindHtml",function(){beforeEach(module("ngSanitize")),it("should set html",inject(function(e,t){var n=t('<div ng-bind-html="html"></div>')(e);e.html="<div unknown>hello</div>",e.$digest(),expect(c(n.html())).toEqual("<div>hello</div>")})),it("should reset html when value is null or undefined",inject(function(e,n){var o=e('<div ng-bind-html="html"></div>')(n);t.forEach([null,void 0,""],function(e){n.html="some val",n.$digest(),expect(c(o.html())).toEqual("some val"),n.html=e,n.$digest(),expect(c(o.html())).toEqual("")})}))}),describe("linky",function(){var e;beforeEach(module("ngSanitize")),beforeEach(inject(function(t){e=t("linky")})),it("should do basic filter",function(){expect(e("http://ab/ (http://a/) <http://a/> http://1.2/v:~-123. c “http://example.com” ‘http://me.com’")).toEqual('<a href="http://ab/">http://ab/</a> (<a href="http://a/">http://a/</a>) &lt;<a href="http://a/">http://a/</a>&gt; <a href="http://1.2/v:~-123">http://1.2/v:~-123</a>. c &#8220;<a href="http://example.com">http://example.com</a>&#8221; &#8216;<a href="http://me.com">http://me.com</a>&#8217;'),expect(e(void 0)).not.toBeDefined()}),it('should return `undefined`/`null`/`""` values unchanged',function(){expect(e(void 0)).toBeUndefined(),expect(e(null)).toBe(null),expect(e("")).toBe("")}),it("should throw an error when used with a non-string value (other than `undefined`/`null`)",function(){expect(function(){e(!1)}).toThrowMinErr("linky","notstring","Expected string but received: false"),expect(function(){e(!0)}).toThrowMinErr("linky","notstring","Expected string but received: true"),expect(function(){e(0)}).toThrowMinErr("linky","notstring","Expected string but received: 0"),expect(function(){e(42)}).toThrowMinErr("linky","notstring","Expected string but received: 42"),expect(function(){e({})}).toThrowMinErr("linky","notstring","Expected string but received: {}"),expect(function(){e([])}).toThrowMinErr("linky","notstring","Expected string but received: []"),expect(function(){e(u)}).toThrowMinErr("linky","notstring","Expected string but received: function noop()")}),it("should be case-insensitive",function(){expect(e("WWW.example.com")).toEqual('<a href="http://WWW.example.com">WWW.example.com</a>'),expect(e("WWW.EXAMPLE.COM")).toEqual('<a href="http://WWW.EXAMPLE.COM">WWW.EXAMPLE.COM</a>'),expect(e("HTTP://www.example.com")).toEqual('<a href="HTTP://www.example.com">HTTP://www.example.com</a>'),expect(e("HTTP://example.com")).toEqual('<a href="HTTP://example.com">HTTP://example.com</a>'),expect(e("HTTPS://www.example.com")).toEqual('<a href="HTTPS://www.example.com">HTTPS://www.example.com</a>'),expect(e("HTTPS://example.com")).toEqual('<a href="HTTPS://example.com">HTTPS://example.com</a>'),expect(e("FTP://www.example.com")).toEqual('<a href="FTP://www.example.com">FTP://www.example.com</a>'),expect(e("FTP://example.com")).toEqual('<a href="FTP://example.com">FTP://example.com</a>'),expect(e("SFTP://www.example.com")).toEqual('<a href="SFTP://www.example.com">SFTP://www.example.com</a>'),expect(e("SFTP://example.com")).toEqual('<a href="SFTP://example.com">SFTP://example.com</a>')}),it("should handle www.",function(){expect(e("www.example.com")).toEqual('<a href="http://www.example.com">www.example.com</a>')}),it("should handle mailto:",function(){expect(e("mailto:me@example.com")).toEqual('<a href="mailto:me@example.com">me@example.com</a>'),expect(e("me@example.com")).toEqual('<a href="mailto:me@example.com">me@example.com</a>'),expect(e("send email to me@example.com, but")).toEqual('send email to <a href="mailto:me@example.com">me@example.com</a>, but'),expect(e('my email is "me@example.com"')).toEqual('my email is &#34;<a href="mailto:me@example.com">me@example.com</a>&#34;')}),it("should handle quotes in the email",function(){expect(e('foo@"bar".com')).toEqual('<a href="mailto:foo@&#34;bar&#34;.com">foo@&#34;bar&#34;.com</a>')}),it("should handle target:",function(){expect(e("http://example.com","_blank")).toBeOneOf('<a target="_blank" href="http://example.com">http://example.com</a>','<a href="http://example.com" target="_blank">http://example.com</a>'),expect(e("http://example.com","someNamedIFrame")).toBeOneOf('<a target="someNamedIFrame" href="http://example.com">http://example.com</a>','<a href="http://example.com" target="someNamedIFrame">http://example.com</a>')}),describe("custom attributes",function(){it("should optionally add custom attributes",function(){expect(e("http://example.com","_self",{rel:"nofollow"})).toBeOneOf('<a rel="nofollow" target="_self" href="http://example.com">http://example.com</a>','<a href="http://example.com" target="_self" rel="nofollow">http://example.com</a>')}),it("should override target parameter with custom attributes",function(){expect(e("http://example.com","_self",{target:"_blank"})).toBeOneOf('<a target="_blank" href="http://example.com">http://example.com</a>','<a href="http://example.com" target="_blank">http://example.com</a>')}),it("should optionally add custom attributes from function",function(){expect(e("http://example.com","_self",function(e){return{"class":"blue"}})).toBeOneOf('<a class="blue" target="_self" href="http://example.com">http://example.com</a>','<a href="http://example.com" target="_self" class="blue">http://example.com</a>','<a class="blue" href="http://example.com" target="_self">http://example.com</a>')}),it("should pass url as parameter to custom attribute function",function(){var t=jasmine.createSpy("linkParameters").and.returnValue({"class":"blue"});e("http://example.com","_self",t),expect(t).toHaveBeenCalledWith("http://example.com")}),it("should call the attribute function for all links in the input",function(){var t=jasmine.createSpy("attributeFn").and.returnValue({});e("http://example.com and http://google.com","_self",t),expect(t.calls.allArgs()).toEqual([["http://example.com"],["http://google.com"]])}),it("should strip unsafe attributes",function(){expect(e("http://example.com","_self",{"class":"blue",onclick:"alert('Hi')"})).toBeOneOf('<a class="blue" target="_self" href="http://example.com">http://example.com</a>','<a href="http://example.com" target="_self" class="blue">http://example.com</a>','<a class="blue" href="http://example.com" target="_self">http://example.com</a>')})})}),describe("HTML",function(){var t,n=e.navigator.userAgent;/Chrome/.test(n)&&!/Edge/.test(n);beforeEach(module("ngSanitize")),beforeEach(function(){t=function(e){var t;return inject(function(e){t=e}),expect(t(e))}}),describe("htmlParser",function(){var e,n,o,a;beforeEach(function(){o="",n=null,e={start:function(e,t){n={tag:e,attrs:t};for(var o=0,a=t.length;a>o;o++){var r=t[o],i=r.key,s=r.value;t[i]=s.replace(/^\s*/,"").replace(/\s*$/,"")}},chars:function(e){o+=e},end:function(e){expect(e).toEqual(n.tag)},comment:function(e){a=e}},inject(function(e){})}),it("should not parse comments",function(){h("<!--FOOBAR-->",e),expect(a).not.toBeDefined()}),it("should parse basic format",function(){h('<tag attr="value">text</tag>',e),expect(n).toEqual({tag:"tag",attrs:{attr:"value"}}),expect(o).toEqual("text")}),it('should not treat "<" followed by a non-/ or non-letter as a tag',function(){t("<- text1 text2 <1 text1 text2 <{",e).toBe("&lt;- text1 text2 &lt;1 text1 text2 &lt;{")}),it('should accept tag delimiters such as "<" inside real tags',function(){h("<p> 10 < 100 </p>",e),expect(o).toEqual(" 10 < 100 ")}),it("should parse newlines in tags",function(){h('<tag\n attr="value"\n>text</\ntag\n>',e),expect(n).toEqual({tag:"tag",attrs:{attr:"value"}}),expect(o).toEqual("text")}),it("should parse newlines in attributes",function(){h('<tag attr="\nvalue\n">text</tag>',e),expect(n).toEqual({tag:"tag",attrs:{attr:"\nvalue\n"}}),expect(o).toEqual("text")}),it("should parse namespace",function(){h('<ns:t-a-g ns:a-t-t-r="\nvalue\n">text</ns:t-a-g>',e),expect(n).toEqual({tag:"ns:t-a-g",attrs:{"ns:a-t-t-r":"\nvalue\n"}}),expect(o).toEqual("text")}),it("should parse empty value attribute of node",function(){h('<test-foo selected value="">abc</test-foo>',e),expect(n).toEqual({tag:"test-foo",attrs:{selected:"",value:""}}),expect(o).toEqual("abc")})}),it("should echo html",function(){t('hello<b class="1\'23" align=\'""\'>world</b>.').toBeOneOf('hello<b class="1\'23" align="&#34;&#34;">world</b>.','hello<b align="&#34;&#34;" class="1\'23">world</b>.')}),it("should remove script",function(){t("a<SCRIPT>evil< / scrIpt >c.").toEqual("a"),t("a<SCRIPT>evil</scrIpt>c.").toEqual("ac.")}),it("should remove script that has newline characters",function(){t("a<SCRIPT\n>\n\revil\n\r</scrIpt\n >c.").toEqual("ac.")}),it("should remove DOCTYPE header",function(){t("<!DOCTYPE html>").toEqual(""),t('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"\n"http://www.w3.org/TR/html4/strict.dtd">').toEqual(""),t("a<!DOCTYPE html>c.").toEqual("ac."),t("a<!DocTyPe html>c.").toEqual("ac.")}),it("should escape non-start tags",function(){t("a< SCRIPT >A< SCRIPT >evil< / scrIpt >B< / scrIpt >c.").toBe("a&lt; SCRIPT &gt;A&lt; SCRIPT &gt;evil&lt; / scrIpt &gt;B&lt; / scrIpt &gt;c.")}),it("should remove attrs",function(){t('a<div style="abc">b</div>c').toEqual("a<div>b</div>c")}),it("should handle large datasets",function(){for(var e=17,n="<div>b</div>",o=0;e>o;o++)n+=n;t("a"+n+"c").toEqual("a"+n+"c")}),it("should remove style",function(){t("a<STyle>evil</stYle>c.").toEqual("ac.")}),it("should remove style that has newline characters",function(){t("a<STyle \n>\n\revil\n\r</stYle\n>c.").toEqual("ac.")}),it("should remove script and style",function(){t("a<STyle>evil<script></script></stYle>c.").toEqual("ac.")}),it("should remove double nested script",function(){t("a<SCRIPT>ev<script>evil</sCript>il</scrIpt>c.").toEqual("ailc.")}),it("should remove unknown  names",function(){t("a<xxx><B>b</B></xxx>c").toEqual("a<b>b</b>c")}),it("should remove unsafe value",function(){t('<a href="javascript:alert()">').toEqual("<a></a>"),t('<img src="foo.gif" usemap="#foomap">').toEqual('<img src="foo.gif">')}),it("should handle self closed elements",function(){t("a<hr/>c").toEqual("a<hr>c")}),it("should handle namespace",function(){t("a<my:hr/><my:div>b</my:div>c").toEqual("abc")}),it("should handle entities",function(){var e="<div rel=\"!@#$%^&amp;*()_+-={}[]:&#34;;'&lt;&gt;?,./`~ &#295;\">!@#$%^&amp;*()_+-={}[]:&#34;;'&lt;&gt;?,./`~ &#295;</div>";t(e).toEqual(e)}),it("should mangle improper html",function(){t('< div rel="</div>" alt=abc dir=\'"\' >text< /div>').toBe("&lt; div rel=&#34;&#34; alt=abc dir='&#34;' &gt;text&lt; /div&gt;")}),it("should mangle improper html2",function(){t('< div rel="</div>" / >').toBe("&lt; div rel=&#34;&#34; / &gt;")}),it("should ignore back slash as escape",function(){t('<img alt="xxx\\" title="><script>....">').toBeOneOf('<img alt="xxx\\" title="&gt;&lt;script&gt;....">','<img title="&gt;&lt;script&gt;...." alt="xxx\\">')}),it("should ignore object attributes",function(){t('<a constructor="hola">:)</a>').toEqual("<a>:)</a>"),t('<constructor constructor="hola">:)</constructor>').toEqual("")}),it("should keep spaces as prefix/postfix",function(){t(" a ").toEqual(" a ")}),it("should allow multiline strings",function(){t("\na\n").toEqual("&#10;a&#10;")}),it('should accept tag delimiters such as "<" inside real tags (with nesting)',function(){t("<p> 10 < <span>100</span> </p>").toEqual("<p> 10 &lt; <span>100</span> </p>")}),it("should accept non-string arguments",function(){t(null).toBe(""),t(void 0).toBe(""),t(42).toBe("42"),t({}).toBe("[object Object]"),t([1,2,3]).toBe("1,2,3"),t(!0).toBe("true"),t(!1).toBe("false")}),it("should strip svg elements if not enabled via provider",function(){t('<svg width="400px" height="150px" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="40" stroke="black" stroke-width="3" fill="red"></svg>').toEqual("")}),it("should prevent mXSS attacks",function(){t('<a href="&#x3000;javascript:alert(1)">CLICKME</a>').toBe("<a>CLICKME</a>")}),it("should strip html comments",function(){t("<!-- comment 1 --><p>text1<!-- comment 2 -->text2</p><!-- comment 3 -->").toEqual("<p>text1text2</p>")}),describe("clobbered elements",function(){it('should throw on a form with an input named "parentNode"',function(){inject(function(e){expect(function(){e('<form><input name="parentNode" /></form>')}).toThrowMinErr("$sanitize","elclob"),expect(function(){e('<form><div><div><input name="parentNode" /></div></div></form>')}).toThrowMinErr("$sanitize","elclob")})}),/Edge\/\d{2,}/.test(e.navigator.userAgent)||it('should throw on a form with an input named "nextSibling"',function(){inject(function(e){expect(function(){e('<form><input name="nextSibling" /></form>')}).toThrowMinErr("$sanitize","elclob"),expect(function(){e('<form><div><div><input name="nextSibling" /></div></div></form>')}).toThrowMinErr("$sanitize","elclob")})})}),it("should not allow JavaScript execution when creating inert document",inject(function(t){t('<svg><g onload="window.xxx = 100"></g></svg>'),expect(e.xxx).toBe(void 0),delete e.xxx})),it("should not allow JavaScript hidden in badly formed HTML to get through sanitization (Firefox bug)",inject(function(e){var t=e('<svg><p><style><img src="</style><img src=x onerror=alert(1)//">');expect(t).toEqual('<p><img src="x"></p>')})),describe("Custom white-list support",function(){var e;beforeEach(module(function(t){e=t,e.addValidElements(["foo"]),e.addValidElements({htmlElements:["foo-button","foo-video"],htmlVoidElements:["foo-input"],svgElements:["foo-svg"]}),e.addValidAttrs(["foo"])})),it("should allow custom white-listed element",function(){t("<foo></foo>").toEqual("<foo></foo>"),t("<foo-button></foo-button>").toEqual("<foo-button></foo-button>"),t("<foo-video></foo-video>").toEqual("<foo-video></foo-video>")}),it("should allow custom white-listed void element",function(){t("<foo-input/>").toEqual("<foo-input>")}),it("should allow custom white-listed void element to be used with closing tag",function(){t("<foo-input></foo-input>").toEqual("<foo-input>")}),it("should allow custom white-listed attribute",function(){t('<foo-input foo="foo"/>').toEqual('<foo-input foo="foo">')}),it("should ignore custom white-listed SVG element if SVG disabled",function(){t("<foo-svg></foo-svg>").toEqual("")}),it("should not allow add custom element after service has been instantiated",inject(function(n){e.addValidElements(["bar"]),t("<bar></bar>").toEqual("")}))}),describe("SVG support",function(){beforeEach(module(function(e){e.enableSvg(!0),e.addValidElements({svgElements:["font-face-uri"]})})),it("should accept SVG tags",function(){t('<svg width="400px" height="150px" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="40" stroke="black" stroke-width="3" fill="red"></svg>').toBeOneOf('<svg width="400px" height="150px" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="40" stroke="black" stroke-width="3" fill="red"></circle></svg>','<svg xmlns="http://www.w3.org/2000/svg" height="150px" width="400px"><circle fill="red" stroke-width="3" stroke="black" r="40" cy="50" cx="50"></circle></svg>','<svg width="400px" height="150px" xmlns="http://www.w3.org/2000/svg"><circle fill="red" stroke="black" stroke-width="3" cx="50" cy="50" r="40"></circle></svg>','<svg width="400px" height="150px" xmlns="http://www.w3.org/2000/svg"><circle FILL="red" STROKE="black" STROKE-WIDTH="3" cx="50" cy="50" r="40"></circle></svg>')}),it("should not ignore white-listed svg camelCased attributes",function(){t('<svg preserveAspectRatio="true"></svg>').toBeOneOf('<svg preserveAspectRatio="true"></svg>','<svg preserveAspectRatio="true" xmlns="http://www.w3.org/2000/svg"></svg>')}),it("should allow custom white-listed SVG element",function(){t("<font-face-uri></font-face-uri>").toEqual("<font-face-uri></font-face-uri>")}),it("should sanitize SVG xlink:href attribute values",function(){t('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><a xlink:href="javascript:alert()"></a></svg>').toBeOneOf('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><a></a></svg>','<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><a></a></svg>','<svg xmlns="http://www.w3.org/2000/svg"><a xmlns:xlink="http://www.w3.org/1999/xlink"></a></svg>'),t('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><a xlink:href="https://example.com"></a></svg>').toBeOneOf('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><a xlink:href="https://example.com"></a></svg>','<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><a xlink:href="https://example.com"></a></svg>','<svg xmlns="http://www.w3.org/2000/svg"><a xlink:href="https://example.com" xmlns:xlink="http://www.w3.org/1999/xlink"></a></svg>','<svg xmlns="http://www.w3.org/2000/svg"><a xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://example.com"></a></svg>')}),it("should sanitize SVG xml:base attribute values",function(){t('<svg xmlns="http://www.w3.org/2000/svg"><a xml:base="javascript:alert(1)//" href="#"></a></svg>').toEqual('<svg xmlns="http://www.w3.org/2000/svg"><a href="#"></a></svg>'),t('<svg xmlns="http://www.w3.org/2000/svg"><a xml:base="https://example.com" href="#"></a></svg>').toEqual('<svg xmlns="http://www.w3.org/2000/svg"><a xml:base="https://example.com" href="#"></a></svg>')}),it("should sanitize unknown namespaced SVG attributes",function(){t('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><a xlink:foo="javascript:alert()"></a></svg>').toBeOneOf('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><a></a></svg>','<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><a></a></svg>','<svg xmlns="http://www.w3.org/2000/svg"><a></a></svg>'),t('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><a xlink:bar="https://example.com"></a></svg>').toBeOneOf('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><a></a></svg>','<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><a></a></svg>','<svg xmlns="http://www.w3.org/2000/svg"><a></a></svg>')}),it("should not accept SVG animation tags",function(){t('<svg xmlns:xlink="http://www.w3.org/1999/xlink"><a><text y="1em">Click me</text><animate attributeName="xlink:href" values="javascript:alert(1)"/></a></svg>').toBeOneOf('<svg xmlns:xlink="http://www.w3.org/1999/xlink"><a><text y="1em">Click me</text></a></svg>','<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><a><text y="1em">Click me</text></a></svg>','<svg xmlns="http://www.w3.org/2000/svg"><a><text y="1em">Click me</text></a></svg>'),t('<svg><a xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="?"><circle r="400"></circle><animate attributeName="xlink:href" begin="0" from="javascript:alert(1)" to="&" /></a></svg>').toBeOneOf('<svg><a xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="?"><circle r="400"></circle></a></svg>','<svg><a xlink:href="?" xmlns:xlink="http://www.w3.org/1999/xlink"><circle r="400"></circle></a></svg>','<svg xmlns="http://www.w3.org/2000/svg"><a xlink:href="?" xmlns:xlink="http://www.w3.org/1999/xlink"><circle r="400"></circle></a></svg>','<svg xmlns="http://www.w3.org/2000/svg"><a xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="?"><circle r="400"></circle></a></svg>')}),it("should not accept SVG `use` tags",function(){t('<svg><use xlink:href="test.svg#xss" /></svg>').toBeOneOf("<svg></svg>",'<svg xmlns:xlink="http://www.w3.org/1999/xlink"></svg>','<svg xmlns="http://www.w3.org/2000/svg"></svg>')})}),describe("htmlSanitizerWriter",function(){var e,t,n;beforeEach(function(){t="",n=jasmine.createSpy("uriValidator"),e=p({push:function(e){t+=e}},n)}),it("should write basic HTML",function(){e.chars("before"),e.start("div",{rel:"123"},!1),e.chars("in"),e.end("div"),e.chars("after"),expect(t).toEqual('before<div rel="123">in</div>after')}),it("should escape text nodes",function(){e.chars("a<div>&</div>c"),expect(t).toEqual("a&lt;div&gt;&amp;&lt;/div&gt;c")}),it("should escape IE script",function(){e.chars("&<>{}"),expect(t).toEqual("&amp;&lt;&gt;{}")}),it("should escape attributes",function(){e.start("div",{rel:"!@#$%^&*()_+-={}[]:\";'<>?,./`~ \n\x00\rħ"}),expect(t).toEqual('<div rel="!@#$%^&amp;*()_+-={}[]:&#34;;\'&lt;&gt;?,./`~ &#10;&#0;&#13;&#295;">')}),it("should ignore misformed elements",function(){e.start("d>i&v",{}),expect(t).toEqual("")}),it("should ignore unknown attributes",function(){e.start("div",{unknown:""}),expect(t).toEqual("<div>")}),it("should handle surrogate pair",function(){e.chars(String.fromCharCode(55357,56374)),expect(t).toEqual("&#128054;")}),describe("explicitly disallow",function(){it("should not allow attributes",function(){e.start("div",{id:"a",name:"a",style:"a"}),expect(t).toEqual("<div>")}),it("should not allow tags",function(){function n(t){e.start(t,{}),e.end(t)}n("frameset"),n("frame"),n("form"),n("param"),n("object"),n("embed"),n("textarea"),n("input"),n("button"),n("option"),n("select"),n("script"),n("style"),n("link"),n("base"),n("basefont"),expect(t).toEqual("")})}),describe("uri validation",function(){it("should call the uri validator",function(){e.start("a",{href:"someUrl"},!1),expect(n).toHaveBeenCalledWith("someUrl",!1),n.calls.reset(),e.start("img",{src:"someImgUrl"},!1),expect(n).toHaveBeenCalledWith("someImgUrl",!0),n.calls.reset(),e.start("someTag",{src:"someNonUrl"},!1),expect(n).not.toHaveBeenCalled()}),it("should drop non valid uri attributes",function(){n.and.returnValue(!1),e.start("a",{href:"someUrl"},!1),expect(t).toEqual("<a>"),t="",n.and.returnValue(!0),e.start("a",{href:"someUrl"},!1),expect(t).toEqual('<a href="someUrl">')})})}),describe("uri checking",function(){beforeEach(function(){jasmine.addMatchers({toBeValidUrl:function(){return{compare:function(e){var t;inject(function(e){t=e});var n='<a href="'+e+'"></a>';return{pass:t(n)===n}}}}})}),it("should use $$sanitizeUri for a[href] links",function(){var e=jasmine.createSpy("$$sanitizeUri");module(function(t){t.value("$$sanitizeUri",e)}),inject(function(){e.and.returnValue("someUri"),t('<a href="someUri"></a>').toEqual('<a href="someUri"></a>'),expect(e).toHaveBeenCalledWith("someUri",!1),e.and.returnValue("unsafe:someUri"),t('<a href="someUri"></a>').toEqual("<a></a>")})}),it("should use $$sanitizeUri for img[src] links",function(){var e=jasmine.createSpy("$$sanitizeUri");module(function(t){t.value("$$sanitizeUri",e)}),inject(function(){e.and.returnValue("someUri"),t('<img src="someUri"/>').toEqual('<img src="someUri">'),expect(e).toHaveBeenCalledWith("someUri",!0),e.and.returnValue("unsafe:someUri"),t('<img src="someUri"/>').toEqual("<img>")})}),it("should be URI",function(){expect("").toBeValidUrl(),expect("http://abc").toBeValidUrl(),expect("HTTP://abc").toBeValidUrl(),expect("https://abc").toBeValidUrl(),expect("HTTPS://abc").toBeValidUrl(),expect("ftp://abc").toBeValidUrl(),expect("FTP://abc").toBeValidUrl(),expect("mailto:me@example.com").toBeValidUrl(),expect("MAILTO:me@example.com").toBeValidUrl(),expect("tel:123-123-1234").toBeValidUrl(),expect("TEL:123-123-1234").toBeValidUrl(),expect("#anchor").toBeValidUrl(),expect("/page1.md").toBeValidUrl()}),it("should not be URI",function(){expect("javascript:alert").not.toBeValidUrl()}),describe("javascript URLs",function(){it("should ignore javascript:",function(){expect("JavaScript:abc").not.toBeValidUrl(),expect(" \n Java\n Script:abc").not.toBeValidUrl(),expect("http://JavaScript/my.js").toBeValidUrl()}),it("should ignore dec encoded javascript:",function(){expect("&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;").not.toBeValidUrl(),expect("&#106&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;").not.toBeValidUrl(),expect("&#106 &#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;").not.toBeValidUrl()}),it("should ignore decimal with leading 0 encoded javascript:",function(){expect("&#0000106&#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058").not.toBeValidUrl(),expect("&#0000106 &#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058").not.toBeValidUrl(),expect("&#0000106; &#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058").not.toBeValidUrl()}),it("should ignore hex encoded javascript:",function(){expect("&#x6A&#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&#x3A;").not.toBeValidUrl(),expect("&#x6A;&#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&#x3A;").not.toBeValidUrl(),expect("&#x6A &#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&#x3A;").not.toBeValidUrl()}),it("should ignore hex encoded whitespace javascript:",function(){expect("jav&#x09;ascript:alert();").not.toBeValidUrl(),expect("jav&#x0A;ascript:alert();").not.toBeValidUrl(),expect("jav&#x0A ascript:alert();").not.toBeValidUrl(),expect("jav\x00ascript:alert();").not.toBeValidUrl(),expect("java\x00\x00script:alert();").not.toBeValidUrl(),
expect(" &#14; java\x00\x00script:alert();").not.toBeValidUrl()})})}),describe("sanitizeText",function(){it("should escape text",function(){expect(o("a<div>&</div>c")).toEqual("a&lt;div&gt;&amp;&lt;/div&gt;c")})})}),describe("decodeEntities",function(){var e,t;beforeEach(function(){t="",e={start:function(){},chars:function(e){t=e},end:function(){},comment:function(){}},module("ngSanitize")}),it("should unescape text",function(){h("a&lt;div&gt;&amp;&lt;/div&gt;c",e),expect(t).toEqual("a<div>&</div>c")}),it("should preserve whitespace",function(){h("  a&amp;b ",e),expect(t).toEqual("  a&b ")})})}(window,window.angular);