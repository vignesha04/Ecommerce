!function(e,t){"use strict";function n(e,t){if(c(e)){t=t||[];for(var n=0,o=e.length;o>n;n++)t[n]=e[n]}else if(u(e)){t=t||{};for(var r in e)("$"!==r.charAt(0)||"$"!==r.charAt(1))&&(t[r]=e[r])}return t||e}function o(e,t){var n=[],o=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[?*])?/g,function(e,t,o,r){var a="?"===r||"*?"===r,i="*"===r||"*?"===r;return n.push({name:o,optional:a}),t=t||"",(a?"(?:"+t:t+"(?:")+(i?"(.+?)":"([^/]+)")+(a?"?)?":")")}).replace(/([/$*])/g,"\\$1");return t.ignoreTrailingSlashes&&(o=o.replace(/\/+$/,"")+"/*"),{keys:n,regexp:new RegExp("^"+o+"(?:[?#]|$)",t.caseInsensitiveMatch?"i":"")}}function r(){function e(e,n){return t.extend(Object.create(e),n)}c=t.isArray,u=t.isObject,d=t.isDefined,h=t.noop;var r={};this.when=function(e,a){var i=n(a);if(t.isUndefined(i.reloadOnUrl)&&(i.reloadOnUrl=!0),t.isUndefined(i.reloadOnSearch)&&(i.reloadOnSearch=!0),t.isUndefined(i.caseInsensitiveMatch)&&(i.caseInsensitiveMatch=this.caseInsensitiveMatch),r[e]=t.extend(i,{originalPath:e},e&&o(e,i)),e){var s="/"===e[e.length-1]?e.substr(0,e.length-1):e+"/";r[s]=t.extend({originalPath:e,redirectTo:e},o(s,i))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(e){return"string"==typeof e&&(e={redirectTo:e}),this.when(null,e),this},p=!0,this.eagerInstantiationEnabled=function(e){return d(e)?(p=e,this):p},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce","$browser",function(n,o,a,i,s,l,c,u){function d(e,t){var n=t.keys,o={};if(!t.regexp)return null;var r=t.regexp.exec(e);if(!r)return null;for(var a=1,i=r.length;i>a;++a){var s=n[a-1],l=r[a];s&&l&&(o[s.name]=l)}return o}function p(e){var t=A.current;$=C(),B=y($,t),B||!t&&!$||n.$broadcast("$routeChangeStart",$,t).defaultPrevented&&e&&e.preventDefault()}function f(){var e=A.current,o=$;if(B)e.params=o.params,t.copy(e.params,a),n.$broadcast("$routeUpdate",e);else if(o||e){E=!1,A.current=o;var r=i.resolve(o);u.$$incOutstandingRequestCount("$route"),r.then(m).then(v).then(function(i){return i&&r.then(x).then(function(r){o===A.current&&(o&&(o.locals=r,t.copy(o.params,a)),n.$broadcast("$routeChangeSuccess",o,e))})})["catch"](function(t){o===A.current&&n.$broadcast("$routeChangeError",o,e,t)})["finally"](function(){u.$$completeOutstandingRequest(h,"$route")})}}function m(e){var n={route:e,hasRedirection:!1};if(e)if(e.redirectTo)if(t.isString(e.redirectTo))n.path=w(e.redirectTo,e.params),n.search=e.params,n.hasRedirection=!0;else{var r=o.path(),a=o.search(),l=e.redirectTo(e.pathParams,r,a);t.isDefined(l)&&(n.url=l,n.hasRedirection=!0)}else if(e.resolveRedirectTo)return i.resolve(s.invoke(e.resolveRedirectTo)).then(function(e){return t.isDefined(e)&&(n.url=e,n.hasRedirection=!0),n});return n}function v(e){var t=!0;if(e.route!==A.current)t=!1;else if(e.hasRedirection){var n=o.url(),r=e.url;r?o.url(r).replace():r=o.path(e.path).search(e.search).replace().url(),r!==n&&(t=!1)}return t}function x(e){if(e){var n=t.extend({},e.resolve);t.forEach(n,function(e,o){n[o]=t.isString(e)?s.get(e):s.invoke(e,null,null,o)});var o=b(e);return t.isDefined(o)&&(n.$template=o),i.all(n)}}function b(e){var n,o;return t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(o=e.templateUrl)&&(t.isFunction(o)&&(o=o(e.params)),t.isDefined(o)&&(e.loadedTemplateUrl=c.valueOf(o),n=l(o))),n}function C(){var n,a;return t.forEach(r,function(r,i){!a&&(n=d(o.path(),r))&&(a=e(r,{params:t.extend({},o.search(),n),pathParams:n}),a.$$route=r)}),a||r[null]&&e(r[null],{params:{},pathParams:{}})}function y(e,n){return!E&&e&&n&&e.$$route===n.$$route&&(!e.reloadOnUrl||!e.reloadOnSearch&&t.equals(e.pathParams,n.pathParams))}function w(e,n){var o=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)o.push(e);else{var r=e.match(/(\w+)(?:[?*])?(.*)/),a=r[1];o.push(n[a]),o.push(r[2]||""),delete n[a]}}),o.join("")}var $,B,E=!1,A={routes:r,reload:function(){E=!0;var e={defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0,E=!1}};n.$evalAsync(function(){p(e),e.defaultPrevented||f()})},updateParams:function(e){if(!this.current||!this.current.$$route)throw g("norout","Tried updating route with no current route");e=t.extend({},this.current.params,e),o.path(w(this.current.$$route.originalPath,e)),o.search(e)}};return n.$on("$locationChangeStart",p),n.$on("$locationChangeSuccess",f),A}]}function a(e){p&&e.get("$route")}function i(){this.$get=function(){return{}}}function s(e,n,o){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(r,a,i,s,l){function c(){p&&(o.cancel(p),p=null),d&&(d.$destroy(),d=null),h&&(p=o.leave(h),p.done(function(e){e!==!1&&(p=null)}),h=null)}function u(){var i=e.current&&e.current.locals,s=i&&i.$template;if(t.isDefined(s)){var u=r.$new(),p=e.current,m=l(u,function(e){o.enter(e,null,h||a).done(function(e){e===!1||!t.isDefined(f)||f&&!r.$eval(f)||n()}),c()});h=m,d=p.scope=u,d.$emit("$viewContentLoaded"),d.$eval(g)}else c()}var d,h,p,f=i.autoscroll,g=i.onload||"";r.$on("$routeChangeSuccess",u),u()}}}function l(e,t,n){return{restrict:"ECA",priority:-400,link:function(o,r){var a=n.current,i=a.locals;r.html(i.$template);var s=e(r.contents());if(a.controller){i.$scope=o;var l=t(a.controller,i);a.controllerAs&&(o[a.controllerAs]=l),r.data("$ngControllerController",l),r.children().data("$ngControllerController",l)}o[a.resolveAs||"$resolve"]=i,s(o)}}}!function(e,t){function n(e,t,n){if(!e)throw pe("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function o(e,t){return e||t?e?t?(W(e)&&(e=e.join(" ")),W(t)&&(t=t.join(" ")),e+" "+t):e:t:""}function r(e){var t={};return e&&(e.to||e.from)&&(t.to=e.to,t.from=e.from),t}function a(e,t,n){var o="";return e=W(e)?e:e&&J(e)&&e.length?e.split(/\s+/):[],V(e,function(e,r){e&&e.length>0&&(o+=r>0?" ":"",o+=n?t+e:e+t)}),o}function i(e,t){var n=e.indexOf(t);t>=0&&e.splice(n,1)}function s(e){if(e instanceof ee)switch(e.length){case 0:return e;case 1:if(e[0].nodeType===R)return e;break;default:return ee(l(e))}return e.nodeType===R?ee(e):void 0}function l(e){if(!e[0])return e;for(var t=0;t<e.length;t++){var n=e[t];if(n.nodeType===R)return n}}function c(e,t,n){V(t,function(t){e.addClass(t,n)})}function u(e,t,n){V(t,function(t){e.removeClass(t,n)})}function d(e){return function(t,n){n.addClass&&(c(e,t,n.addClass),n.addClass=null),n.removeClass&&(u(e,t,n.removeClass),n.removeClass=null)}}function h(e){if(e=e||{},!e.$$prepared){var t=e.domOperation||te;e.domOperation=function(){e.$$domOperationFired=!0,t(),t=te},e.$$prepared=!0}return e}function p(e,t){f(e,t),g(e,t)}function f(e,t){t.from&&(e.css(t.from),t.from=null)}function g(e,t){t.to&&(e.css(t.to),t.to=null)}function m(e,t,n){var o=t.options||{},r=n.options||{},a=(o.addClass||"")+" "+(r.addClass||""),i=(o.removeClass||"")+" "+(r.removeClass||""),s=v(e.attr("class"),a,i);r.preparationClasses&&(o.preparationClasses=$(r.preparationClasses,o.preparationClasses),delete r.preparationClasses);var l=o.domOperation!==te?o.domOperation:null;return L(o,r),l&&(o.domOperation=l),s.addClass?o.addClass=s.addClass:o.addClass=null,s.removeClass?o.removeClass=s.removeClass:o.removeClass=null,t.addClass=o.addClass,t.removeClass=o.removeClass,o}function v(e,t,n){function o(e){J(e)&&(e=e.split(" "));var t={};return V(e,function(e){e.length&&(t[e]=!0)}),t}var r=1,a=-1,i={};e=o(e),t=o(t),V(t,function(e,t){i[t]=r}),n=o(n),V(n,function(e,t){i[t]=i[t]===r?null:a});var s={addClass:"",removeClass:""};return V(i,function(t,n){var o,i;t===r?(o="addClass",i=!e[n]||e[n+U]):t===a&&(o="removeClass",i=e[n]||e[n+I]),i&&(s[o].length&&(s[o]+=" "),s[o]+=n)}),s}function x(e){return e instanceof ee?e[0]:e}function b(e,t,n,o){var r="";n&&(r=a(n,z,!0)),o.addClass&&(r=$(r,a(o.addClass,I))),o.removeClass&&(r=$(r,a(o.removeClass,U))),r.length&&(o.preparationClasses=r,t.addClass(r))}function C(e,t){t.preparationClasses&&(e.removeClass(t.preparationClasses),t.preparationClasses=null),t.activeClasses&&(e.removeClass(t.activeClasses),t.activeClasses=null)}function y(e,t){var n=t?"paused":"",o=O+se;return w(e,[o,n]),[o,n]}function w(e,t){var n=t[0],o=t[1];e.style[n]=o}function $(e,t){return e?t?e+" "+t:e:t}function B(e){return[ue,e+"s"]}function E(e,t){var n=t?ce:de;return[n,e+"s"]}function A(e,t,n){var o=Object.create(null),r=e.getComputedStyle(t)||{};return V(n,function(e,t){var n=r[e];if(n){var a=n.charAt(0);("-"===a||"+"===a||a>=0)&&(n=k(n)),0===n&&(n=null),o[t]=n}}),o}function k(e){var t=0,n=e.split(/\s*,\s*/);return V(n,function(e){"s"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e=parseFloat(e)||0,t=t?Math.max(e,t):e}),t}function _(e){return 0===e||null!=e}function S(e,t){var n=T,o=e+"s";return t?n+=ne:o+=" linear all",[n,o]}function q(e,t,n){V(n,function(n){e[n]=Z(e[n])?e[n]:t.style.getPropertyValue(n)})}var T,j,O,H,R=1,I="-add",U="-remove",z="ng-",D="-active",P="-prepare",M="ng-animate",G="$$ngAnimateChildren",F="";void 0===e.ontransitionend&&void 0!==e.onwebkittransitionend?(F="-webkit-",T="WebkitTransition",j="webkitTransitionEnd transitionend"):(T="transition",j="transitionend"),void 0===e.onanimationend&&void 0!==e.onwebkitanimationend?(F="-webkit-",O="WebkitAnimation",H="webkitAnimationEnd animationend"):(O="animation",H="animationend");var N,L,V,W,Z,K,Y,X,J,Q,ee,te,ne="Duration",oe="Property",re="Delay",ae="TimingFunction",ie="IterationCount",se="PlayState",le=9999,ce=O+re,ue=O+ne,de=T+re,he=T+ne,pe=t.$$minErr("ng"),fe={blockTransitions:function(e,t){var n=t?"-"+t+"s":"";return w(e,[de,n]),[de,n]}},ge=["$$rAF",function(e){function t(e){o=o.concat(e),n()}function n(){if(o.length){for(var t=o.shift(),a=0;a<t.length;a++)t[a]();r||e(function(){r||n()})}}var o,r;return o=t.queue=[],t.waitUntilQuiet=function(t){r&&r(),r=e(function(){r=null,t(),n()})},t}],me=["$interpolate",function(e){return{link:function(t,n,o){function r(e){e="on"===e||"true"===e,n.data(G,e)}var a=o.ngAnimateChildren;J(a)&&0===a.length?n.data(G,!0):(r(e(a)(t)),o.$observe("ngAnimateChildren",r))}}}],ve="$$animateCss",xe=1e3,be=3,Ce=1.5,ye={transitionDuration:he,transitionDelay:de,transitionProperty:T+oe,animationDuration:ue,animationDelay:ce,animationIterationCount:O+ie},we={transitionDuration:he,transitionDelay:de,animationDuration:ue,animationDelay:ce},$e=["$animateProvider",function(e){this.$get=["$window","$$jqLite","$$AnimateRunner","$timeout","$$animateCache","$$forceReflow","$sniffer","$$rAFScheduler","$$animateQueue",function(e,t,n,o,s,l,c,u,m){function v(t,n,o,r,a){var i=s.get(o);i||(i=A(e,t,a),"infinite"===i.animationIterationCount&&(i.animationIterationCount=1));var l=r||i.transitionDuration>0||i.animationDuration>0;return s.put(o,i,l),i}function b(n,o,r,i){var l,c="stagger-"+r;if(s.count(r)>0&&(l=s.get(c),!l)){var u=a(o,"-stagger");t.addClass(n,u),l=A(e,n,i),l.animationDuration=Math.max(l.animationDuration,0),l.transitionDuration=Math.max(l.transitionDuration,0),t.removeClass(n,u),s.put(c,l,!0)}return l||{}}function C(e){R.push(e),u.waitUntilQuiet(function(){s.flush();for(var e=l(),t=0;t<R.length;t++)R[t](e);R.length=0})}function $(e,t,n,o){var r=v(e,t,n,o,ye),a=r.animationDelay,i=r.transitionDelay;return r.maxDelay=a&&i?Math.max(a,i):a||i,r.maxDuration=Math.max(r.animationDuration*r.animationIterationCount,r.transitionDuration),r}var k=d(t),R=[];return function(e,l){function u(){v()}function d(){v(!0)}function v(n){if(!(Z||Y&&K)){Z=!0,K=!1,ye&&!G.$$skipPreparationClasses&&t.removeClass(e,ye),ze&&t.removeClass(e,ze),y(L,!1),fe.blockTransitions(L,!1),V(se,function(e){L.style[e[0]]=""}),k(e,G),p(e,G),Object.keys(F).length&&V(F,function(e,t){e?L.style.setProperty(t,e):L.style.removeProperty(t)}),G.onDone&&G.onDone(),de&&de.length&&e.off(de.join(" "),P);var r=e.data(ve);r&&(o.cancel(r[0].timer),e.removeData(ve)),X&&X.complete(!n)}}function A(e){Ue.blockTransition&&fe.blockTransitions(L,e),Ue.blockKeyframeAnimation&&y(L,!!e)}function R(){return X=new n({end:u,cancel:d}),C(te),v(),{$$willAnimate:!1,start:function(){return X},end:u}}function P(e){e.stopPropagation();var t=e.originalEvent||e;if(t.target===L){var n=t.$manualTimeStamp||Date.now(),o=parseFloat(t.elapsedTime.toFixed(be));Math.max(n-ie,0)>=ee&&o>=ne&&(Y=!0,v())}}function M(){function n(){if(!Z){if(A(!1),V(se,function(e){var t=e[0],n=e[1];L.style[t]=n}),k(e,G),t.addClass(e,ze),Ue.recalculateTimingStyles){if($e=L.getAttribute("class")+" "+ye,ke=s.cacheKey(L,he,G.addClass,G.removeClass),Re=$(L,$e,ke,!1),Ie=Re.maxDelay,Q=Math.max(Ie,0),ne=Re.maxDuration,0===ne)return void v();Ue.hasTransitions=Re.transitionDuration>0,Ue.hasAnimations=Re.animationDuration>0}if(Ue.applyAnimationDelay&&(Ie="boolean"!=typeof G.delay&&_(G.delay)?parseFloat(G.delay):Ie,Q=Math.max(Ie,0),Re.animationDelay=Ie,De=E(Ie,!0),se.push(De),L.style[De[0]]=De[1]),ee=Q*xe,re=ne*xe,G.easing){var n,a=G.easing;Ue.hasTransitions&&(n=T+ae,se.push([n,a]),L.style[n]=a),Ue.hasAnimations&&(n=O+ae,se.push([n,a]),L.style[n]=a)}Re.transitionDuration&&de.push(j),Re.animationDuration&&de.push(H),ie=Date.now();var i=ee+Ce*re,l=ie+i,c=e.data(ve)||[],u=!0;if(c.length){var d=c[0];u=l>d.expectedEndTime,u?o.cancel(d.timer):c.push(v)}if(u){var h=o(r,i,!1);c[0]={timer:h,expectedEndTime:l},c.push(v),e.data(ve,c)}de.length&&e.on(de.join(" "),P),G.to&&(G.cleanupStyles&&q(F,L,Object.keys(G.to)),g(e,G))}}function r(){var t=e.data(ve);if(t){for(var n=1;n<t.length;n++)t[n]();e.removeData(ve)}}if(!Z){if(!L.parentNode)return void v();var a=function(e){if(Y)K&&e&&(K=!1,v());else if(K=!e,Re.animationDuration){var t=y(L,K);K?se.push(t):i(se,t)}},l=Oe>0&&(Re.transitionDuration&&0===Ae.transitionDuration||Re.animationDuration&&0===Ae.animationDuration)&&Math.max(Ae.animationDelay,Ae.transitionDelay);l?o(n,Math.floor(l*Oe*xe),!1):n(),J.resume=function(){a(!0)},J.pause=function(){a(!1)}}}var G=l||{};G.$$prepared||(G=h(N(G)));var F={},L=x(e);if(!L||!L.parentNode||!m.enabled())return R();var Z,K,Y,X,J,Q,ee,ne,re,ie,se=[],ce=e.attr("class"),ue=r(G),de=[];if(0===G.duration||!c.animations&&!c.transitions)return R();var he=G.event&&W(G.event)?G.event.join(" "):G.event,pe=he&&G.structural,ge="",me="";pe?ge=a(he,z,!0):he&&(ge=he),G.addClass&&(me+=a(G.addClass,I)),G.removeClass&&(me.length&&(me+=" "),me+=a(G.removeClass,U)),G.applyClassesEarly&&me.length&&k(e,G);var ye=[ge,me].join(" ").trim(),$e=ce+" "+ye,Be=ue.to&&Object.keys(ue.to).length>0,Ee=(G.keyframeStyle||"").length>0;if(!Ee&&!Be&&!ye)return R();var Ae,ke=s.cacheKey(L,he,G.addClass,G.removeClass);if(s.containsCachedAnimationWithoutDuration(ke))return ye=null,R();if(G.stagger>0){var _e=parseFloat(G.stagger);Ae={transitionDelay:_e,animationDelay:_e,transitionDuration:0,animationDuration:0}}else Ae=b(L,ye,ke,we);G.$$skipPreparationClasses||t.addClass(e,ye);var Se;if(G.transitionStyle){var qe=[T,G.transitionStyle];w(L,qe),se.push(qe)}if(G.duration>=0){Se=L.style[T].length>0;var Te=S(G.duration,Se);w(L,Te),se.push(Te)}if(G.keyframeStyle){var je=[O,G.keyframeStyle];w(L,je),se.push(je)}var Oe=Ae?G.staggerIndex>=0?G.staggerIndex:s.count(ke):0,He=0===Oe;He&&!G.skipBlocking&&fe.blockTransitions(L,le);var Re=$(L,$e,ke,!pe),Ie=Re.maxDelay;Q=Math.max(Ie,0),ne=Re.maxDuration;var Ue={};if(Ue.hasTransitions=Re.transitionDuration>0,Ue.hasAnimations=Re.animationDuration>0,Ue.hasTransitionAll=Ue.hasTransitions&&"all"===Re.transitionProperty,Ue.applyTransitionDuration=Be&&(Ue.hasTransitions&&!Ue.hasTransitionAll||Ue.hasAnimations&&!Ue.hasTransitions),Ue.applyAnimationDuration=G.duration&&Ue.hasAnimations,Ue.applyTransitionDelay=_(G.delay)&&(Ue.applyTransitionDuration||Ue.hasTransitions),Ue.applyAnimationDelay=_(G.delay)&&Ue.hasAnimations,Ue.recalculateTimingStyles=me.length>0,(Ue.applyTransitionDuration||Ue.applyAnimationDuration)&&(ne=G.duration?parseFloat(G.duration):ne,Ue.applyTransitionDuration&&(Ue.hasTransitions=!0,Re.transitionDuration=ne,Se=L.style[T+oe].length>0,se.push(S(ne,Se))),Ue.applyAnimationDuration&&(Ue.hasAnimations=!0,Re.animationDuration=ne,se.push(B(ne)))),0===ne&&!Ue.recalculateTimingStyles)return R();var ze=a(ye,D);if(null!=G.delay){var De;"boolean"!=typeof G.delay&&(De=parseFloat(G.delay),Q=Math.max(De,0)),Ue.applyTransitionDelay&&se.push(E(De)),Ue.applyAnimationDelay&&se.push(E(De,!0))}return null==G.duration&&Re.transitionDuration>0&&(Ue.recalculateTimingStyles=Ue.recalculateTimingStyles||He),ee=Q*xe,re=ne*xe,G.skipBlocking||(Ue.blockTransition=Re.transitionDuration>0,Ue.blockKeyframeAnimation=Re.animationDuration>0&&Ae.animationDelay>0&&0===Ae.animationDuration),G.from&&(G.cleanupStyles&&q(F,L,Object.keys(G.from)),f(e,G)),Ue.blockTransition||Ue.blockKeyframeAnimation?A(ne):G.skipBlocking||fe.blockTransitions(L,!1),{$$willAnimate:!0,end:u,start:function(){return Z?void 0:(J={end:u,cancel:d,resume:null,pause:null},X=new n(J),C(M),X)}}}}]}],Be=["$$animationProvider",function(e){function t(e){return e.parentNode&&11===e.parentNode.nodeType}e.drivers.push("$$animateCssDriver");var n="ng-animate-shim",o="ng-anchor",r="ng-anchor-out",a="ng-anchor-in";this.$get=["$animateCss","$rootScope","$$AnimateRunner","$rootElement","$sniffer","$$jqLite","$document",function(e,i,s,l,c,u,d){function h(e){return e.replace(/\bng-\S+\b/g,"")}function p(e,t){return J(e)&&(e=e.split(" ")),J(t)&&(t=t.split(" ")),e.filter(function(e){return-1===t.indexOf(e)}).join(" ")}function f(t,i,l){function c(e){var t={},n=x(e).getBoundingClientRect();return V(["width","height","top","left"],function(e){var o=n[e];switch(e){case"top":o+=v.scrollTop;break;case"left":o+=v.scrollLeft}t[e]=Math.floor(o)+"px"}),t}function u(){var t=e(m,{addClass:r,delay:!0,from:c(i)});return t.$$willAnimate?t:null}function d(e){return e.attr("class")||""}function f(){var t=h(d(l)),n=p(t,b),o=p(b,t),i=e(m,{to:c(l),addClass:a+" "+n,removeClass:r+" "+o,delay:!0});return i.$$willAnimate?i:null}function g(){m.remove(),i.removeClass(n),l.removeClass(n)}var m=ee(x(i).cloneNode(!0)),b=h(d(m));i.addClass(n),l.addClass(n),m.addClass(o),C.append(m);var y,w=u();if(!w&&(y=f(),!y))return g();var $=w||y;return{start:function(){function e(){n&&n.end()}var t,n=$.start();return n.done(function(){return n=null,!y&&(y=f())?(n=y.start(),n.done(function(){n=null,g(),t.complete()}),n):(g(),void t.complete())}),t=new s({end:e,cancel:e})}}}function g(e,t,n,o){var r=m(e,te),a=m(t,te),i=[];return V(o,function(e){var t=e.out,o=e["in"],r=f(n,t,o);r&&i.push(r)}),r||a||0!==i.length?{start:function(){function e(){V(t,function(e){e.end()})}var t=[];r&&t.push(r.start()),a&&t.push(a.start()),V(i,function(e){t.push(e.start())});var n=new s({end:e,cancel:e});return s.all(t,function(e){n.complete(e)}),n}}:void 0}function m(t){var n=t.element,o=t.options||{};t.structural&&(o.event=t.event,o.structural=!0,o.applyClassesEarly=!0,"leave"===t.event&&(o.onDone=o.domOperation)),o.preparationClasses&&(o.event=$(o.event,o.preparationClasses));var r=e(n,o);return r.$$willAnimate?r:null}if(!c.animations&&!c.transitions)return te;var v=d[0].body,b=x(l),C=ee(t(b)||v.contains(b)?b:v);return function(e){return e.from&&e.to?g(e.from,e.to,e.classes,e.anchors):m(e)}}]}],Ee=["$animateProvider",function(e){this.$get=["$injector","$$AnimateRunner","$$jqLite",function(t,n,o){function r(n){n=W(n)?n:n.split(" ");for(var o=[],r={},a=0;a<n.length;a++){var i=n[a],s=e.$$registeredAnimations[i];s&&!r[i]&&(o.push(t.get(s)),r[i]=!0)}return o}var a=d(o);return function(e,t,o,i){function s(){i.domOperation(),a(e,i)}function l(){f=!0,s(),p(e,i)}function c(e,t,o,r,a){var i;switch(o){case"animate":i=[t,r.from,r.to,a];break;case"setClass":i=[t,v,x,a];break;case"addClass":i=[t,v,a];break;case"removeClass":i=[t,x,a];break;default:i=[t,a]}i.push(r);var s=e.apply(e,i);if(s)if(Y(s.start)&&(s=s.start()),s instanceof n)s.done(a);else if(Y(s))return s;return te}function u(e,t,o,r,a){var i=[];return V(r,function(r){var s=r[a];s&&i.push(function(){var r,a,i=!1,l=function(e){i||(i=!0,(a||te)(e),r.complete(!e))};return r=new n({end:function(){l()},cancel:function(){l(!0)}}),a=c(s,e,t,o,function(e){var t=e===!1;l(t)}),r})}),i}function d(e,t,o,r,a){var i=u(e,t,o,r,a);if(0===i.length){var s,l;"beforeSetClass"===a?(s=u(e,"removeClass",o,r,"beforeRemoveClass"),l=u(e,"addClass",o,r,"beforeAddClass")):"setClass"===a&&(s=u(e,"removeClass",o,r,"removeClass"),l=u(e,"addClass",o,r,"addClass")),s&&(i=i.concat(s)),l&&(i=i.concat(l))}if(0!==i.length)return function(e){var t=[];return i.length&&V(i,function(e){t.push(e())}),t.length?n.all(t,e):e(),function(e){V(t,function(t){e?t.cancel():t.end()})}}}var f=!1;3===arguments.length&&X(o)&&(i=o,o=null),i=h(i),o||(o=e.attr("class")||"",i.addClass&&(o+=" "+i.addClass),i.removeClass&&(o+=" "+i.removeClass));var g,m,v=i.addClass,x=i.removeClass,b=r(o);if(b.length){var C,y;"leave"===t?(y="leave",C="afterLeave"):(y="before"+t.charAt(0).toUpperCase()+t.substr(1),C=t),"enter"!==t&&"move"!==t&&(g=d(e,t,i,b,y)),m=d(e,t,i,b,C)}if(g||m){var w;return{$$willAnimate:!0,end:function(){return w?w.end():(l(),w=new n,w.complete(!0)),w},start:function(){function e(e){l(e),w.complete(e)}function t(t){f||((o||te)(t),e(t))}if(w)return w;w=new n;var o,r=[];return g&&r.push(function(e){o=g(e)}),r.length?r.push(function(e){s(),e(!0)}):s(),m&&r.push(function(e){o=m(e)}),w.setHost({end:function(){t()},cancel:function(){t(!0)}}),n.chain(r,e),w}}}}}]}],Ae=["$$animationProvider",function(e){e.drivers.push("$$animateJsDriver"),this.$get=["$$animateJs","$$AnimateRunner",function(e,t){function n(t){var n=t.element,o=t.event,r=t.options,a=t.classes;return e(n,o,a,r)}return function(e){if(e.from&&e.to){var o=n(e.from),r=n(e.to);if(!o&&!r)return;return{start:function(){function e(){return function(){V(a,function(e){e.end()})}}function n(e){i.complete(e)}var a=[];o&&a.push(o.start()),r&&a.push(r.start()),t.all(a,n);var i=new t({end:e(),cancel:e()});return i}}}return n(e)}}]}],ke="data-ng-animate",_e="$ngAnimatePin",Se=["$animateProvider",function(t){function o(e){return{addClass:e.addClass,removeClass:e.removeClass,from:e.from,to:e.to}}function r(e){if(!e)return null;var t=e.split(g),n=Object.create(null);return V(t,function(e){n[e]=!0}),n}function a(e,t){if(e&&t){var n=r(t);return e.split(g).some(function(e){return n[e]})}}function i(e,t,n){return v[e].some(function(e){return e(t,n)})}function c(e,t){var n=(e.addClass||"").length>0,o=(e.removeClass||"").length>0;return t?n&&o:n||o}var u=1,f=2,g=" ",v=this.rules={skip:[],cancel:[],join:[]};v.join.push(function(e,t){return!e.structural&&c(e)}),v.skip.push(function(e,t){return!e.structural&&!c(e)}),v.skip.push(function(e,t){return"leave"===t.event&&e.structural}),v.skip.push(function(e,t){return t.structural&&t.state===f&&!e.structural}),v.cancel.push(function(e,t){return t.structural&&e.structural}),v.cancel.push(function(e,t){return t.state===f&&e.structural}),v.cancel.push(function(e,t){if(t.structural)return!1;var n=e.addClass,o=e.removeClass,r=t.addClass,i=t.removeClass;return Q(n)&&Q(o)||Q(r)&&Q(i)?!1:a(n,i)||a(o,r)}),this.$get=["$$rAF","$rootScope","$rootElement","$document","$$Map","$$animation","$$AnimateRunner","$templateRequest","$$jqLite","$$forceReflow","$$isDocumentHidden",function(r,a,g,v,y,w,$,B,E,A,k){function _(e){M["delete"](e.target)}function S(){var e=!1;return function(t){e?t():a.$$postDigest(function(){e=!0,t()})}}function q(e,t){return m(e,t,{})}function T(e,t,n){var o=[],r=te[n];return r&&V(r,function(r){le.call(r.node,t)?o.push(r.callback):"leave"===n&&le.call(r.node,e)&&o.push(r.callback)}),o}function j(e,t,n){var o=l(t);return e.filter(function(e){var t=e.node===o&&(!n||e.callback===n);return!t})}function O(e,t){"close"!==e||t.parentNode||ce.off(t)}function H(e,t,n){function l(e,t,n,o){_(function(){var e=T(B,y,t);e.length?r(function(){V(e,function(e){e(v,n,o)}),O(n,y)}):O(n,y)}),e.progress(t,n,o)}function d(e){C(v,g),se(v,g),p(v,g),g.domOperation(),A.complete(!e)}var g=N(n),v=s(e),y=x(v),B=y&&y.parentNode;g=h(g);var A=new $,_=S();if(W(g.addClass)&&(g.addClass=g.addClass.join(" ")),g.addClass&&!J(g.addClass)&&(g.addClass=null),W(g.removeClass)&&(g.removeClass=g.removeClass.join(" ")),g.removeClass&&!J(g.removeClass)&&(g.removeClass=null),g.from&&!X(g.from)&&(g.from=null),g.to&&!X(g.to)&&(g.to=null),!(F&&y&&ae(y,t,n)&&ie(y,g)))return d(),A;var j=["enter","move","leave"].indexOf(t)>=0,H=k(),R=H||M.get(y),G=!R&&P.get(y)||{},L=!!G.state;if(R||L&&G.state===u||(R=!z(y,B,t)),R)return H&&l(A,t,"start",o(g)),d(),H&&l(A,t,"close",o(g)),A;j&&I(y);var Z={structural:j,element:v,event:t,addClass:g.addClass,removeClass:g.removeClass,close:d,options:g,runner:A};if(L){var K=i("skip",Z,G);if(K)return G.state===f?(d(),A):(m(v,G,Z),G.runner);var Y=i("cancel",Z,G);if(Y)if(G.state===f)G.runner.end();else{if(!G.structural)return m(v,G,Z),G.runner;G.close()}else{var Q=i("join",Z,G);if(Q){if(G.state!==f)return b(E,v,j?t:null,g),t=Z.event=G.event,g=m(v,G,Z),G.runner;q(v,Z)}}}else q(v,Z);var ee=Z.structural;if(ee||(ee="animate"===Z.event&&Object.keys(Z.options.to||{}).length>0||c(Z)),!ee)return d(),U(y),A;var te=(G.counter||0)+1;return Z.counter=te,D(y,u,Z),a.$$postDigest(function(){v=s(e);var n=P.get(y),r=!n;n=n||{};var a=v.parent()||[],i=a.length>0&&("animate"===n.event||n.structural||c(n));if(r||n.counter!==te||!i)return r&&(se(v,g),p(v,g)),(r||j&&n.event!==t)&&(g.domOperation(),A.end()),void(i||U(y));t=!n.structural&&c(n,!0)?"setClass":n.event,D(y,f);var u=w(v,t,n.options);A.setHost(u),l(A,t,"start",o(g)),u.done(function(e){d(!e);var n=P.get(y);n&&n.counter===te&&U(y),l(A,t,"close",o(g))})}),A}function I(e){var t=e.querySelectorAll("["+ke+"]");V(t,function(e){var t=parseInt(e.getAttribute(ke),10),n=P.get(e);if(n)switch(t){case f:n.runner.end();case u:P["delete"](e)}})}function U(e){e.removeAttribute(ke),P["delete"](e)}function z(e,t,n){var o,r=v[0].body,a=x(g),i=e===r||"HTML"===e.nodeName,s=e===a,l=!1,c=M.get(e),u=ee.data(e,_e);for(u&&(t=x(u));t&&(s||(s=t===a),t.nodeType===R);){var d=P.get(t)||{};if(!l){var h=M.get(t);if(h===!0&&c!==!1){c=!0;break}h===!1&&(c=!1),l=d.structural}if(Q(o)||o===!0){var p=ee.data(t,G);Z(p)&&(o=p)}if(l&&o===!1)break;if(i||(i=t===r),i&&s)break;t=s||!(u=ee.data(t,_e))?t.parentNode:x(u)}var f=(!l||o)&&c!==!0;return f&&s&&i}function D(e,t,n){n=n||{},n.state=t,e.setAttribute(ke,t);var o=P.get(e),r=o?L(o,n):n;P.set(e,r)}var P=new y,M=new y,F=null,Y=a.$watch(function(){return 0===B.totalPendingRequests},function(e){e&&(Y(),a.$$postDigest(function(){a.$$postDigest(function(){null===F&&(F=!0)})}))}),te=Object.create(null),ne=t.customFilter(),oe=t.classNameFilter(),re=function(){return!0},ae=ne||re,ie=oe?function(e,t){var n=[e.getAttribute("class"),t.addClass,t.removeClass].join(" ");return oe.test(n)}:re,se=d(E),le=e.Node.prototype.contains||function(e){return this===e||!!(16&this.compareDocumentPosition(e))},ce={on:function(e,t,n){var o=l(t);te[e]=te[e]||[],te[e].push({node:o,callback:n}),ee(t).on("$destroy",function(){var r=P.get(o);r||ce.off(e,t,n)})},off:function(e,t,n){if(1!==arguments.length||J(arguments[0])){var o=te[e];o&&(te[e]=1===arguments.length?null:j(o,t,n))}else{t=arguments[0];for(var r in te)te[r]=j(te[r],t)}},pin:function(e,t){n(K(e),"element","not an element"),n(K(t),"parentElement","not an element"),e.data(_e,t)},push:function(e,t,n,o){return n=n||{},n.domOperation=o,H(e,t,n)},enabled:function(e,t){var n=arguments.length;if(0===n)t=!!F;else{var o=K(e);if(o){var r=x(e);1===n?t=!M.get(r):(M.has(r)||ee(e).on("$destroy",_),M.set(r,!t))}else t=F=!!e}return t}};return ce}]}],qe=function(){var e="$$ngAnimateParentKey",t=0,n=Object.create(null);this.$get=[function(){return{cacheKey:function(n,o,r,a){var i=n.parentNode,s=i[e]||(i[e]=++t),l=[s,o,n.getAttribute("class")];return r&&l.push(r),a&&l.push(a),l.join(" ")},containsCachedAnimationWithoutDuration:function(e){var t=n[e];return t&&!t.isValid||!1},flush:function(){n=Object.create(null)},count:function(e){var t=n[e];return t?t.total:0},get:function(e){var t=n[e];return t&&t.value},put:function(e,t,o){n[e]?(n[e].total++,n[e].value=t):n[e]={total:1,value:t,isValid:o}}}}]},Te=["$animateProvider",function(e){function t(e,t){e.data(s,t)}function n(e){e.removeData(s)}function r(e){return e.data(s)}var a="ng-animate-ref",i=this.drivers=[],s="$$animationRunner",l="$$animatePrepareClasses";this.$get=["$$jqLite","$rootScope","$injector","$$AnimateRunner","$$Map","$$rAFScheduler","$$animateCache",function(e,s,c,u,f,g,m){function v(e){function t(e){if(e.processed)return e;e.processed=!0;var n=e.domNode,o=n.parentNode;a.set(n,e);for(var i;o;){if(i=a.get(o)){i.processed||(i=t(i));break}o=o.parentNode}return(i||r).children.push(e),e}function n(e){var t,n=[],o=[];for(t=0;t<e.children.length;t++)o.push(e.children[t]);var r=o.length,a=0,i=[];for(t=0;t<o.length;t++){var s=o[t];0>=r&&(r=a,a=0,n.push(i),i=[]),i.push(s),s.children.forEach(function(e){a++,o.push(e)}),r--}return i.length&&n.push(i),n}var o,r={children:[]},a=new f;for(o=0;o<e.length;o++){var i=e[o];a.set(i.domNode,e[o]={domNode:i.domNode,element:i.element,fn:i.fn,children:[]})}for(o=0;o<e.length;o++)t(e[o]);return n(r)}var b=[],C=d(e);return function(d,f,y){function w(e){var t="["+a+"]",n=e.hasAttribute(a)?[e]:e.querySelectorAll(t),o=[];return V(n,function(e){var t=e.getAttribute(a);t&&t.length&&o.push(e)}),o}function $(e){var t=[],n={};V(e,function(e,o){var r=e.element,i=x(r),s=e.event,l=["enter","move"].indexOf(s)>=0,c=e.structural?w(i):[];if(c.length){var u=l?"to":"from";V(c,function(e){var t=e.getAttribute(a);n[t]=n[t]||{},n[t][u]={animationID:o,element:ee(e)}})}else t.push(e)});var o={},r={};return V(n,function(n,a){var i=n.from,s=n.to;if(!i||!s){var l=i?i.animationID:s.animationID,c=l.toString();return void(o[c]||(o[c]=!0,t.push(e[l])))}var u=e[i.animationID],d=e[s.animationID],h=i.animationID.toString();if(!r[h]){var p=r[h]={structural:!0,beforeStart:function(){u.beforeStart(),d.beforeStart()},close:function(){u.close(),d.close()},classes:B(u.classes,d.classes),from:u,to:d,anchors:[]};p.classes.length?t.push(p):(t.push(u),t.push(d))}r[h].anchors.push({out:i.element,"in":s.element})}),t}function B(e,t){e=e.split(" "),t=t.split(" ");for(var n=[],o=0;o<e.length;o++){var r=e[o];if("ng-"!==r.substring(0,3))for(var a=0;a<t.length;a++)if(r===t[a]){n.push(r);break}}return n.join(" ")}function E(e){for(var t=i.length-1;t>=0;t--){var n=i[t],o=c.get(n),r=o(e);if(r)return r}}function A(){O=(O?O+" ":"")+M,e.addClass(d,O);var t=d.data(l);t&&(e.removeClass(d,t),t=null)}function k(e,t){function n(e){var n=r(e);n&&n.setHost(t)}e.from&&e.to?(n(e.from.element),n(e.to.element)):n(e.element)}function _(){var e=r(d);!e||"leave"===f&&y.$$domOperationFired||e.end()}function S(t){d.off("$destroy",_),n(d),C(d,y),p(d,y),y.domOperation(),O&&e.removeClass(d,O),T.complete(!t)}y=h(y);var q=["enter","move","leave"].indexOf(f)>=0,T=new u({end:function(){S()},cancel:function(){S(!0)}});if(!i.length)return S(),T;var j=o(d.attr("class"),o(y.addClass,y.removeClass)),O=y.tempClasses;return O&&(j+=" "+O,y.tempClasses=null),q&&d.data(l,"ng-"+f+P),t(d,T),b.push({element:d,classes:j,event:f,structural:q,options:y,beforeStart:A,close:S}),d.on("$destroy",_),b.length>1?T:(s.$$postDigest(function(){var t=[];V(b,function(e){r(e.element)?t.push(e):e.close()}),b.length=0;var n=$(t),o=[];V(n,function(e){var t=e.from?e.from.element:e.element,n=y.addClass;n=(n?n+" ":"")+M;var a=m.cacheKey(t[0],e.event,n,y.removeClass);o.push({element:t,domNode:x(t),fn:function(){var t,n=e.close;if(m.containsCachedAnimationWithoutDuration(a))return void n();e.beforeStart();var o=e.anchors?e.from.element||e.to.element:e.element;if(r(o)){var i=E(e);i&&(t=i.start)}if(t){var s=t();s.done(function(e){n(!e)}),k(e,s)}else n()}})});for(var a=v(o),i=0;i<a.length;i++)for(var s=a[i],c=0;c<s.length;c++){var u=s[c],d=u.element;if(a[i][c]=u.fn,0!==i){var h=d.data(l);h&&e.addClass(d,h)}else d.removeData(l)}g(a)}),T)}}]}],je=["$animate",function(e){return{restrict:"A",transclude:"element",terminal:!0,priority:550,link:function(t,n,o,r,a){var i,s;t.$watchCollection(o.ngAnimateSwap||o["for"],function(t){i&&e.leave(i),s&&(s.$destroy(),s=null),(t||0===t)&&a(function(t,o){i=t,s=o,e.enter(t,null,n)})})}}}];t.module("ngAnimate",[],function(){te=t.noop,N=t.copy,L=t.extend,ee=t.element,V=t.forEach,W=t.isArray,J=t.isString,X=t.isObject,Q=t.isUndefined,
Z=t.isDefined,Y=t.isFunction,K=t.isElement}).info({angularVersion:"1.7.8"}).directive("ngAnimateSwap",je).directive("ngAnimateChildren",me).factory("$$rAFScheduler",ge).provider("$$animateQueue",Se).provider("$$animateCache",qe).provider("$$animation",Te).provider("$animateCss",$e).provider("$$animateCssDriver",Be).provider("$$animateJs",Ee).provider("$$animateJsDriver",Ae)}(e,e.angular);var c,u,d,h,p,f=t.module("ngRoute",[]).info({angularVersion:"1.7.8"}).provider("$route",r).run(a),g=t.$$minErr("ngRoute");a.$inject=["$injector"],f.provider("$routeParams",i),f.directive("ngView",s),f.directive("ngView",l),s.$inject=["$route","$anchorScroll","$animate"],l.$inject=["$compile","$controller","$route"],describe("ngView",function(){describe("basics",function(){var e;beforeEach(module("ngRoute")),beforeEach(module(function(t){return function(t,n,o){e=n('<div><ng:view onload="load()"></ng:view></div>')(t)}})),afterEach(function(){dealoc(e)}),it("should do nothing when no routes are defined",inject(function(t,n,o){o.path("/unknown"),t.$digest(),expect(e.text()).toEqual("")})),it("should instantiate controller after compiling the content",function(){var e,t=[],n=function(n){e=n,t.push("ctrl-init")};module(function(e,o){e.directive("compileLog",function(){return{compile:function(){t.push("compile")}}}),o.when("/some",{templateUrl:"/tpl.html",controller:n})}),inject(function(n,o,r,a){r.put("/tpl.html",[200,"<div compile-log>partial</div>",{}]),a.path("/some"),o.$digest(),expect(e.$parent).toBe(o),expect(e).toBe(n.current.scope),expect(t).toEqual(["compile","ctrl-init"])})}),it("should instantiate the associated controller when an empty template is downloaded",function(){var e,t=[],n=function(n){e=n,t.push("ctrl-init")};module(function(e){e.when("/some",{templateUrl:"/tpl.html",controller:n})}),inject(function(t,n,o,r){o.put("/tpl.html",[200,"",{}]),r.path("/some"),expect(function(){n.$digest()}).not.toThrow(),expect(e).toBeDefined()})}),it("should instantiate controller with an alias",function(){function e(e){this.name="alias",t=e}var t;module(function(t,n){n.when("/some",{templateUrl:"/tpl.html",controller:e,controllerAs:"ctrl"})}),inject(function(e,n,o,r){o.put("/tpl.html",[200,"<div></div>",{}]),r.path("/some"),n.$digest(),expect(t.ctrl.name).toBe("alias")})}),it("should support string controller declaration",function(){var t=jasmine.createSpy("MyCtrl");module(function(e,n){e.register("MyCtrl",["$scope",t]),n.when("/foo",{controller:"MyCtrl",templateUrl:"/tpl.html"})}),inject(function(n,o,r,a){a.put("/tpl.html",[200,"<div></div>",{}]),o.path("/foo"),r.$digest(),expect(n.current.controller).toBe("MyCtrl"),expect(t).toHaveBeenCalledWith(e.children().scope())})}),it("should reference resolved locals in scope",function(){module(function(e){e.when("/foo",{resolve:{name:function(){return"shahar"}},template:"<div>{{$resolve.name}}</div>"})}),inject(function(t,n){t.path("/foo"),n.$digest(),expect(e.text()).toEqual("shahar")})}),it("should allow to provide an alias for resolved locals using resolveAs",function(){module(function(e){e.when("/foo",{resolveAs:"myResolve",resolve:{name:function(){return"shahar"}},template:"<div>{{myResolve.name}}</div>"})}),inject(function(t,n){t.path("/foo"),n.$digest(),expect(e.text()).toEqual("shahar")})}),it("should load content via xhr when route changes",function(){module(function(e){e.when("/foo",{templateUrl:"myUrl1"}),e.when("/bar",{templateUrl:"myUrl2"})}),inject(function(t,n,o,r,a){expect(e.text()).toEqual(""),r.path("/foo"),o.expect("GET","myUrl1").respond("<div>{{1+3}}</div>"),t.$digest(),o.flush(),expect(e.text()).toEqual("4"),r.path("/bar"),o.expect("GET","myUrl2").respond("angular is da best"),t.$digest(),o.flush(),expect(e.text()).toEqual("angular is da best")})}),it("should use inline content route changes",function(){module(function(e){e.when("/foo",{template:"<div>{{1+3}}</div>"}),e.when("/bar",{template:"AngularJS is da best"}),e.when("/blank",{template:""})}),inject(function(t,n,o,r){expect(e.text()).toEqual(""),o.path("/foo"),t.$digest(),expect(e.text()).toEqual("4"),o.path("/bar"),t.$digest(),expect(e.text()).toEqual("AngularJS is da best"),o.path("/blank"),t.$digest(),expect(e.text()).toEqual("")})}),it("should remove all content when location changes to an unknown route",function(){module(function(e){e.when("/foo",{templateUrl:"myUrl1"})}),inject(function(t,n,o,r,a){o.path("/foo"),r.expect("GET","myUrl1").respond("<div>{{1+3}}</div>"),t.$digest(),r.flush(),expect(e.text()).toEqual("4"),o.path("/unknown"),t.$digest(),expect(e.text()).toEqual("")})}),it("should chain scopes and propagate evals to the child scope",function(){module(function(e){e.when("/foo",{templateUrl:"myUrl1"})}),inject(function(t,n,o,r,a){t.parentVar="parent",o.path("/foo"),r.expect("GET","myUrl1").respond("<div>{{parentVar}}</div>"),t.$digest(),r.flush(),expect(e.text()).toEqual("parent"),t.parentVar="new parent",t.$digest(),expect(e.text()).toEqual("new parent")})}),it("should be possible to nest ngView in ngInclude",function(){module(function(e){e.when("/foo",{templateUrl:"viewPartial.html"})}),inject(function(e,t,n,o,r){e.whenGET("includePartial.html").respond("view: <ng:view></ng:view>"),e.whenGET("viewPartial.html").respond("content"),t.path("/foo");var a=o("<div>include: <ng:include src=\"'includePartial.html'\"> </ng:include></div>")(r);r.$digest(),e.flush(),expect(a.text()).toEqual("include: view: content"),expect(n.current.templateUrl).toEqual("viewPartial.html"),dealoc(a)})}),it("should initialize view template after the view controller was initialized even when templates were cached",function(){function e(e){e.log.push("parent")}module(function(t){t.when("/foo",{controller:e,templateUrl:"viewPartial.html"})}),inject(function(e,t,n,o,r){e.log=[],e.ChildCtrl=function(e){e.log.push("child")},n.path("/foo"),o.expect("GET","viewPartial.html").respond('<div ng-init="log.push(\'init\')"><div ng-controller="ChildCtrl"></div></div>'),e.$apply(),o.flush(),expect(e.log).toEqual(["parent","init","child"]),n.path("/"),e.$apply(),expect(e.log).toEqual(["parent","init","child"]),e.log=[],n.path("/foo"),e.$apply(),expect(e.log).toEqual(["parent","init","child"])})}),it("should discard pending xhr callbacks if a new route is requested before the current finished loading",function(){module(function(e){e.when("/foo",{templateUrl:"myUrl1"}),e.when("/bar",{templateUrl:"myUrl2"})}),inject(function(t,n,o,r){expect(e.text()).toEqual(""),o.path("/foo"),r.expect("GET","myUrl1").respond("<div>{{1+3}}</div>"),n.$digest(),o.path("/bar"),r.expect("GET","myUrl2").respond("<div>{{1+1}}</div>"),n.$digest(),r.flush(),expect(e.text()).toEqual("2")})}),it("should be async even if served from cache",function(){module(function(e){e.when("/foo",{controller:t.noop,templateUrl:"myUrl1"})}),inject(function(t,n,o,r){r.put("myUrl1",[200,"my partial",{}]),o.path("/foo");var a=0;n.$watch(function(){a||expect(e.text()).toBe(""),a++}),n.$digest(),expect(e.text()).toBe("my partial")})}),it("should fire $contentLoaded event when content compiled and linked",function(){var t=[],n=function(e){return function(){t.push(e)}},o=function(e){e.value="bound-value",t.push("init-ctrl")};module(function(e){e.when("/foo",{templateUrl:"tpl.html",controller:o})}),inject(function(o,r,a){r.$on("$routeChangeStart",n("$routeChangeStart")),r.$on("$routeChangeSuccess",n("$routeChangeSuccess")),r.$on("$viewContentLoaded",n("$viewContentLoaded")),o.put("tpl.html",[200,"{{value}}",{}]),a.path("/foo"),r.$digest(),expect(e.text()).toBe("bound-value"),expect(t).toEqual(["$routeChangeStart","init-ctrl","$viewContentLoaded","$routeChangeSuccess"])})}),it("should destroy previous scope",function(){module(function(e){e.when("/foo",{templateUrl:"tpl.html"})}),inject(function(t,n,o){t.put("tpl.html",[200,"partial",{}]),expect(n.$$childHead).toBeNull(),expect(n.$$childTail).toBeNull(),o.path("/foo"),n.$digest(),expect(e.text()).toBe("partial"),expect(n.$$childHead).not.toBeNull(),expect(n.$$childTail).not.toBeNull(),o.path("/non/existing/route"),n.$digest(),expect(e.text()).toBe(""),expect(n.$$childHead).toBeNull(),expect(n.$$childTail).toBeNull()})}),it("should destroy previous scope if multiple route changes occur before server responds",function(){var t=[],n=function(e){return function(n){t.push("init-"+e),n.$on("$destroy",function(){t.push("destroy-"+e)})}};module(function(e){e.when("/one",{templateUrl:"one.html",controller:n("ctrl1")}),e.when("/two",{templateUrl:"two.html",controller:n("ctrl2")})}),inject(function(n,o,r){n.whenGET("one.html").respond("content 1"),n.whenGET("two.html").respond("content 2"),r.path("/one"),o.$digest(),r.path("/two"),o.$digest(),n.flush(),expect(e.text()).toBe("content 2"),expect(t).toEqual(["init-ctrl2"]),r.path("/non-existing"),o.$digest(),expect(e.text()).toBe(""),expect(t).toEqual(["init-ctrl2","destroy-ctrl2"]),expect(o.$$childHead).toBeNull(),expect(o.$$childTail).toBeNull()})}),it("should $destroy scope after update and reload",function(){function e(e){return function(){n.push(e)}}function t(t){return function(o){n.push("init-"+t),o.$on("$destroy",e("destroy-"+t)),o.$on("$routeUpdate",e("route-update"))}}var n=[];module(function(e){e.when("/bar",{templateUrl:"tpl.html",controller:t("bar")}),e.when("/foo",{templateUrl:"tpl.html",controller:t("foo"),reloadOnSearch:!1})}),inject(function(e,t,o){e.put("tpl.html",[200,"partial",{}]),t.url("/foo"),o.$digest(),expect(n).toEqual(["init-foo"]),t.search({q:"some"}),o.$digest(),expect(n).toEqual(["init-foo","route-update"]),t.url("/bar"),o.$digest(),expect(n).toEqual(["init-foo","route-update","destroy-foo","init-bar"])})}),it("should evaluate onload expression after linking the content",function(){module(function(e){e.when("/foo",{templateUrl:"tpl.html"})}),inject(function(e,t,n){e.put("tpl.html",[200,"{{1+1}}",{}]),n.load=jasmine.createSpy("onload"),t.url("/foo"),n.$digest(),expect(n.load).toHaveBeenCalledOnce()})}),it("should set $scope and $controllerController on the view elements (except for non-element nodes)",function(){function t(e){e.state="WORKS",e.ctrl=this}module(function(e){e.when("/foo",{templateUrl:"tpl.html",controller:t})}),inject(function(t,n,o,r){t.put("tpl.html",[200,"   \n   <div>{{state}}</div>",{}]),n.url("/foo"),o.$digest(),expect(e.text()).toEqual("   \n   WORKS");var a=e.find("div");expect(a.parent()[0].nodeName.toUpperCase()).toBeOneOf("NG:VIEW","VIEW"),expect(a.scope()).toBe(r.current.scope),expect(a.scope().hasOwnProperty("state")).toBe(!0),expect(a.scope().state).toEqual("WORKS"),expect(a.controller()).toBe(r.current.scope.ctrl)})}),it("should not set $scope or $controllerController on top level text elements in the view",function(){function n(e){}module(function(e){e.when("/foo",{templateUrl:"tpl.html",controller:n})}),inject(function(n,o,r,a){n.put("tpl.html","<div></div>  "),o.url("/foo"),r.$digest(),t.forEach(e.contents(),function(n){3===n.nodeType?(expect(t.element(n).scope()).not.toBe(a.current.scope),expect(t.element(n).controller()).not.toBeDefined()):8===n.nodeType?(expect(t.element(n).scope()).toBe(e.scope()),expect(t.element(n).controller()).toBe(e.controller())):(expect(t.element(n).scope()).toBe(a.current.scope),expect(t.element(n).controller()).toBeDefined())})})}),it("should not trigger a digest when the view is changed",function(){module(function(e){e.when("/foo",{templateUrl:"myUrl1"}),e.when("/bar",{templateUrl:"myUrl2"})}),inject(function(t,n,o,r,a,i,s){var l=spyOn(o,"$digest").and.callThrough();n.put("myUrl1","my template content"),n.put("myUrl2","my other template content"),i.path("/foo"),o.$digest(),t.flush(),expect(e.text()).toEqual("my template content"),i.path("/bar"),o.$digest(),l.calls.reset(),t.flush(),expect(e.text()).toEqual("my other template content"),expect(l).not.toHaveBeenCalled(),a.verifyNoPendingTasks()})})}),describe("and transcludes",function(){var e,t;beforeEach(module("ngRoute",function(n){e=null,t=n.directive})),afterEach(function(){e&&dealoc(e)}),it("should allow access to directive controller from children when used in a replace template",function(){var n;module(function(e){e.when("/view",{templateUrl:"view.html"}),t("template",function(){return{template:"<div ng-view></div>",replace:!0,controller:function(){this.flag=!0}}}),t("test",function(){return{require:"^template",link:function(e,t,o,r){n=r}}})}),inject(function(t,o,r,a){r.expectGET("view.html").respond("<div><div test></div></div>"),e=t("<div><div template></div></div>")(o),a.url("/view"),o.$apply(),r.flush(),expect(n.flag).toBe(!0)})}),it("should compile its content correctly (although we remove it later)",function(){var t;module(function(e,n){n.when("/view",{template:" "});var o=e.directive;o("test",function(){return{link:function(e,n){t=n}}})}),inject(function(n,o,r){e=n("<div><div ng-view><div test someAttr></div></div></div>")(o),r.url("/view"),o.$apply(),expect(t[0].nodeName).toBe("DIV")})}),it("should link directives on the same element after the content has been loaded",function(){var t;module(function(e,n){n.when("/view",{template:"someContent"}),e.directive("test",function(){return{link:function(e,n){t=n.text()}}})}),inject(function(n,o,r){e=n("<div><div ng-view test></div>")(o),r.url("/view"),o.$apply(),expect(t).toBe("someContent")})}),it("should add the content to the element before compiling it",function(){var t;module(function(e,n){n.when("/view",{template:"<span test></span>"}),e.directive("test",function(){return{link:function(e,n){t=n.parent().parent()}}})}),inject(function(n,o,r){e=n("<div><div ng-view></div>")(o),r.url("/view"),o.$apply(),expect(t[0]).toBe(e[0])})})}),describe("animations",function(){function n(e){return a.html(e),o.append(a),r=a.children().eq(0)}var o,r,a;beforeEach(module("ngRoute")),beforeEach(module(function(){return function(n){a=n,o=t.element(e.document.body)}})),afterEach(function(){dealoc(o),dealoc(r)}),beforeEach(module(function(e,n){return n.when("/foo",{controller:t.noop,templateUrl:"/foo.html"}),n.when("/bar",{controller:t.noop,templateUrl:"/bar.html"}),function(e){e.put("/foo.html",[200,"<div>data</div>",{}]),e.put("/bar.html",[200,"<div>data2</div>",{}])}})),describe("hooks",function(){beforeEach(module("ngAnimate")),beforeEach(module("ngAnimateMock")),it("should fire off the enter animation",inject(function(e,t,o,a,i){r=e(n("<div ng-view></div>"))(t),o.path("/foo"),t.$digest();var s=i.queue.pop();expect(s.event).toBe("enter")})),it("should fire off the leave animation",inject(function(e,t,o,a,i,s){a.put("/foo.html",[200,"<div>foo</div>",{}]),r=e(n("<div ng-view></div>"))(t),o.path("/foo"),t.$digest(),o.path("/"),t.$digest();var l=s.queue.pop();expect(l.event).toBe("leave")})),it("should animate two separate ngView elements",inject(function(e,t,o,a,i){t.tpl="one",r=e(n("<div ng-view></div>"))(t),t.$digest(),a.path("/foo"),t.$digest(),i.queue.pop(),a.path("/bar"),t.$digest();var s=i.queue.pop();expect(s.event).toBe("leave");var l=s.args[0],c=i.queue.pop();expect(c.event).toBe("enter");var u=c.args[0];expect(u).not.toEqual(l)})),it("should render ngClass on ngView",inject(function(e,t,o,a,i){var s;t.tpl="one",t.klass="classy",r=e(n('<div><div ng-view ng-class="klass"></div></div>'))(t),t.$digest(),i.path("/foo"),t.$digest(),a.flush(),a.queue.shift();var l=a.queue.shift();expect(l.event).toBe("addClass"),s=l.element,expect(s.hasClass("classy")).toBe(!0),t.klass="boring",t.$digest(),expect(a.queue.shift().event).toBe("addClass"),expect(a.queue.shift().event).toBe("removeClass"),a.flush(),expect(s.hasClass("classy")).toBe(!1),expect(s.hasClass("boring")).toBe(!0),i.path("/bar"),t.$digest(),a.queue.shift(),l=a.queue.shift(),s=l.element,expect(l.event).toBe("leave"),expect(a.queue.shift().event).toBe("addClass"),expect(s.hasClass("boring")).toBe(!0)})),it("should not double compile when the route changes",function(){module(function(e,t,n){e.when("/foo",{template:'<div ng-repeat="i in [1,2]">{{i}}</div>'}),e.when("/bar",{template:'<div ng-repeat="i in [3,4]">{{i}}</div>'}),t.register(".my-animation",function(){return{leave:function(e,t){t()}}})}),inject(function(e,t,o,a,i,s,l,c){r=t(n('<div><ng:view onload="load()" class="my-animation"></ng:view></div>'))(e),c.enabled(!0),o.path("/foo"),e.$digest(),expect(c.queue.shift().event).toBe("enter"),expect(c.queue.shift().event).toBe("enter"),expect(c.queue.shift().event).toBe("enter"),expect(r.text()).toEqual("12"),o.path("/bar"),e.$digest(),expect(c.queue.shift().event).toBe("enter"),expect(c.queue.shift().event).toBe("leave"),e.$digest(),expect(c.queue.shift().event).toBe("enter"),expect(c.queue.shift().event).toBe("enter"),c.flush(),expect(r.text()).toEqual("34")})}),it("should destroy the previous leave animation if a new one takes place",inject(function(e,t,o,a,i){var s=t.$new();r=e(n("<div><div ng-view></div></div>"))(s),s.$apply("value = true"),a.path("/bar"),t.$digest();var l,c=r.children(0);c.on("$destroy",function(){l=!0}),a.path("/foo"),t.$digest(),a.path("/bar"),t.$digest(),a.path("/bar"),t.$digest(),expect(l).toBe(!0)}))}),describe("autoscroll",function(){function e(){return function(e,n){a=jasmine.createSpy("$anchorScroll"),e.value("$anchorScroll",a),n.when("/foo",{controller:t.noop,template:"<div></div>"})}}function n(){return function(e){spyOn(e,"enter").and.callThrough()}}function o(e){return function(t,n,o){r=t(e)(n)}}var a;beforeEach(module(e(),"ngAnimateMock")),beforeEach(inject(n())),it("should call $anchorScroll if autoscroll attribute is present",inject(o("<div><ng:view autoscroll></ng:view></div>"),function(e,t,n,o){o.path("/foo"),e.$digest(),t.flush(),e.$digest(),expect(t.queue.shift().event).toBe("enter"),expect(a).toHaveBeenCalledOnce()})),it("should call $anchorScroll if autoscroll evaluates to true",inject(o('<div><ng:view src="tpl" autoscroll="value"></ng:view></div>'),function(e,t,n,o){e.value=!0,o.path("/foo"),e.$digest(),t.flush(),e.$digest(),expect(t.queue.shift().event).toBe("enter"),expect(a).toHaveBeenCalledOnce()})),it("should not call $anchorScroll if autoscroll attribute is not present",inject(o("<div><ng:view></ng:view></div>"),function(e,t,n,o){t.path("/foo"),e.$digest(),expect(n.queue.shift().event).toBe("enter"),expect(a).not.toHaveBeenCalled()})),it("should not call $anchorScroll if autoscroll evaluates to false",inject(o('<div><ng:view autoscroll="value"></ng:view></div>'),function(e,t,n,o){e.value=!1,t.path("/foo"),e.$digest(),expect(n.queue.shift().event).toBe("enter"),expect(a).not.toHaveBeenCalled()})),it('should only call $anchorScroll after the "enter" animation completes',inject(o("<div><ng:view autoscroll></ng:view></div>"),function(e,t,n,o){t.path("/foo"),expect(n.enter).not.toHaveBeenCalled(),e.$digest(),expect(a).not.toHaveBeenCalled(),expect(n.queue.shift().event).toBe("enter"),n.flush(),e.$digest(),expect(n.enter).toHaveBeenCalledOnce(),expect(a).toHaveBeenCalledOnce()}))})}),describe("in async template",function(){beforeEach(module("ngRoute")),beforeEach(module(function(e,n,o){e.directive("asyncView",function(){return{templateUrl:"async-view.html"}}),n.decorator("$templateRequest",function(e){return function(){return e(t.identity,500,!1,"<ng-view></ng-view>")}}),o.when("/",{template:"Hello, world!"})})),it("should work correctly upon initial page load",inject(function(e,t,n,o){var r=e("<async-view></async-view>")(n);n.$digest(),o.flush(500),expect(r.text()).toBe("Hello, world!"),dealoc(r)}))})}),describe("$routeParams",function(){beforeEach(module("ngRoute")),it("should publish the params into a service",function(){module(function(e){e.when("/foo",{}),e.when("/bar/:barId",{})}),inject(function(e,t,n,o){n.path("/foo").search("a=b"),e.$digest(),expect(o).toEqual({a:"b"}),n.path("/bar/123").search("x=abc"),e.$digest(),expect(o).toEqual({barId:"123",x:"abc"})})}),it("should correctly extract the params when a param name is part of the route",function(){module(function(e){e.when("/bar/:foo/:bar",{})}),inject(function(e,t,n,o){n.path("/bar/foovalue/barvalue"),e.$digest(),expect(o).toEqual({bar:"barvalue",foo:"foovalue"})})}),it("should support route params not preceded by slashes",function(){module(function(e){e.when("/bar:barId/foo:fooId/",{})}),inject(function(e,t,n,o){n.path("/barbarvalue/foofoovalue/"),e.$digest(),expect(o).toEqual({barId:"barvalue",fooId:"foovalue"})})}),it("should correctly extract the params when an optional param name is part of the route",function(){module(function(e){e.when("/bar/:foo?",{}),e.when("/baz/:foo?/edit",{}),e.when("/qux/:bar?/:baz?",{})}),inject(function(e,t,n,o){n.path("/bar"),e.$digest(),expect(o).toEqual({}),n.path("/bar/fooValue"),e.$digest(),expect(o).toEqual({foo:"fooValue"}),n.path("/baz/fooValue/edit"),e.$digest(),expect(o).toEqual({foo:"fooValue"}),n.path("/baz/edit"),e.$digest(),expect(o).toEqual({}),n.path("/qux//bazValue"),e.$digest(),expect(o).toEqual({baz:"bazValue"})})}),it("should correctly extract path params containing hashes and/or question marks",function(){module(function(e){e.when("/foo/:bar",{}),e.when("/zoo/:bar/:baz/:qux",{})}),inject(function(e,t,n){e.path("/foo/bar?baz"),t.$digest(),expect(n).toEqual({bar:"bar?baz"}),e.path("/foo/bar?baz=val"),t.$digest(),expect(n).toEqual({bar:"bar?baz=val"}),e.path("/foo/bar#baz"),t.$digest(),expect(n).toEqual({bar:"bar#baz"}),e.path("/foo/bar?baz#qux"),t.$digest(),expect(n).toEqual({bar:"bar?baz#qux"}),e.path("/foo/bar?baz=val#qux"),t.$digest(),expect(n).toEqual({bar:"bar?baz=val#qux"}),e.path("/foo/bar#baz?qux"),t.$digest(),expect(n).toEqual({bar:"bar#baz?qux"}),e.path("/zoo/bar?p1=v1#h1/baz?p2=v2#h2/qux?p3=v3#h3"),t.$digest(),expect(n).toEqual({bar:"bar?p1=v1#h1",baz:"baz?p2=v2#h2",qux:"qux?p3=v3#h3"})})})}),describe("$routeProvider",function(){var e;beforeEach(module("ngRoute")),beforeEach(module(function(t){e=t,e.when("/foo",{template:"Hello, world!"})})),it("should support enabling/disabling automatic instantiation upon initial load",inject(function(){expect(e.eagerInstantiationEnabled(!0)).toBe(e),expect(e.eagerInstantiationEnabled()).toBe(!0),expect(e.eagerInstantiationEnabled(!1)).toBe(e),expect(e.eagerInstantiationEnabled()).toBe(!1),expect(e.eagerInstantiationEnabled(!0)).toBe(e),expect(e.eagerInstantiationEnabled()).toBe(!0)})),it("should automatically instantiate `$route` upon initial load",function(){inject(function(e,t){e.path("/foo"),t.$digest()}),inject(function(e){expect(e.current).toBeDefined()})}),it("should not automatically instantiate `$route` if disabled",function(){module(function(e){e.eagerInstantiationEnabled(!1)}),inject(function(e,t){e.path("/foo"),t.$digest()}),inject(function(e){expect(e.current).toBeUndefined()})})}),describe("$route",function(){var e,n;beforeEach(module("ngRoute")),beforeEach(module(function(){return function(t){e=t,e.when("GET","Chapter.html").respond("chapter"),e.when("GET","test.html").respond("test"),e.when("GET","foo.html").respond("foo"),e.when("GET","bar.html").respond("bar"),e.when("GET","baz.html").respond("baz"),e.when("GET","http://example.com/trusted-template.html").respond("cross domain trusted template"),e.when("GET","404.html").respond("not found")}})),afterEach(function(){dealoc(n)}),it("should allow cancellation via $locationChangeStart via $routeChangeStart",function(){module(function(e){e.when("/Edit",{id:"edit",template:"Some edit functionality"}),e.when("/Home",{id:"home"})}),module(provideLog),inject(function(e,t,o,r,a){o.$on("$routeChangeStart",function(e,t,n){"home"===t.id&&n.scope.unsavedChanges&&e.preventDefault()}),n=r("<div><div ng-view></div></div>")(o),o.$apply(function(){t.path("/Edit")}),o.$on("$routeChangeSuccess",a.fn("routeChangeSuccess")),o.$on("$locationChangeSuccess",a.fn("locationChangeSuccess")),o.$apply(function(){e.current.scope.unsavedChanges=!0}),o.$apply(function(){t.path("/Home")}),expect(e.current.id).toBe("edit"),expect(t.path()).toBe("/Edit"),expect(a).toEqual([]),o.$apply(function(){e.current.scope.unsavedChanges=!1}),o.$apply(function(){t.path("/Home")}),expect(e.current.id).toBe("home"),expect(t.path()).toBe("/Home"),expect(a).toEqual(["locationChangeSuccess","routeChangeSuccess"])})}),it("should allow redirects while handling $routeChangeStart",function(){module(function(e){e.when("/some",{id:"some",template:"Some functionality"}),e.when("/redirect",{id:"redirect"})}),module(provideLog),inject(function(e,t,n,o,r){n.$on("$routeChangeStart",function(e,n,o){"some"===n.id&&t.path("/redirect")}),o("<div><div ng-view></div></div>")(n),n.$on("$routeChangeStart",r.fn("routeChangeStart")),n.$on("$routeChangeError",r.fn("routeChangeError")),n.$on("$routeChangeSuccess",r.fn("routeChangeSuccess")),n.$apply(function(){t.path("/some")}),expect(e.current.id).toBe("redirect"),expect(t.path()).toBe("/redirect"),expect(r).toEqual(["routeChangeStart","routeChangeStart","routeChangeSuccess"])})}),it("should route and fire change event",function(){var n,o,r="";module(function(e){e.when("/Book/:book/Chapter/:chapter",{controller:t.noop,templateUrl:"Chapter.html"}),e.when("/Blank",{})}),inject(function(t,a,i){i.$on("$routeChangeStart",function(e,a,i){r+="before();",expect(i).toBe(t.current),n=i,o=a}),i.$on("$routeChangeSuccess",function(e,a,i){r+="after();",expect(a).toBe(t.current),expect(n).toBe(i),expect(o).toBe(a)}),a.path("/Book/Moby/Chapter/Intro").search("p=123"),i.$digest(),e.flush(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({book:"Moby",chapter:"Intro",p:"123"}),r="",a.path("/Blank").search("ignore"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({ignore:!0}),r="",a.path("/NONE"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current).toEqual(void 0)})}),it("should route and fire change event when catch-all params are used",function(){var n,o,r="";module(function(e){e.when("/Book1/:book/Chapter/:chapter/:highlight*/edit",{controller:t.noop,templateUrl:"Chapter.html"}),e.when("/Book2/:book/:highlight*/Chapter/:chapter",{controller:t.noop,templateUrl:"Chapter.html"}),e.when("/Blank",{})}),inject(function(t,a,i){i.$on("$routeChangeStart",function(e,a,i){r+="before();",expect(i).toBe(t.current),n=i,o=a}),i.$on("$routeChangeSuccess",function(e,a,i){r+="after();",expect(a).toBe(t.current),expect(n).toBe(i),expect(o).toBe(a)}),a.path("/Book1/Moby/Chapter/Intro/one/edit").search("p=123"),i.$digest(),e.flush(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({book:"Moby",chapter:"Intro",highlight:"one",p:"123"}),r="",a.path("/Blank").search("ignore"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({ignore:!0}),r="",a.path("/Book1/Moby/Chapter/Intro/one/two/edit").search("p=123"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({book:"Moby",chapter:"Intro",highlight:"one/two",p:"123"}),r="",a.path("/Book2/Moby/one/two/Chapter/Intro").search("p=123"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({book:"Moby",chapter:"Intro",highlight:"one/two",p:"123"}),r="",a.path("/NONE"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current).toEqual(void 0)})}),it("should route and fire change event correctly whenever the case insensitive flag is utilized",function(){var n,o,r="";module(function(e){e.when("/Book1/:book/Chapter/:chapter/:highlight*/edit",{controller:t.noop,templateUrl:"Chapter.html",caseInsensitiveMatch:!0}),e.when("/Book2/:book/:highlight*/Chapter/:chapter",{controller:t.noop,templateUrl:"Chapter.html"}),e.when("/Blank",{})}),inject(function(t,a,i){i.$on("$routeChangeStart",function(e,a,i){r+="before();",expect(i).toBe(t.current),n=i,o=a}),i.$on("$routeChangeSuccess",function(e,a,i){r+="after();",expect(a).toBe(t.current),expect(n).toBe(i),expect(o).toBe(a)}),a.path("/Book1/Moby/Chapter/Intro/one/edit").search("p=123"),i.$digest(),e.flush(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({book:"Moby",chapter:"Intro",highlight:"one",p:"123"}),r="",a.path("/BOOK1/Moby/CHAPTER/Intro/one/EDIT").search("p=123"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({book:"Moby",chapter:"Intro",highlight:"one",p:"123"}),r="",a.path("/Blank").search("ignore"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({ignore:!0}),r="",a.path("/BLANK"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current).toEqual(void 0),r="",a.path("/Book2/Moby/one/two/Chapter/Intro").search("p=123"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current.params).toEqual({book:"Moby",chapter:"Intro",highlight:"one/two",p:"123"}),r="",a.path("/BOOK2/Moby/one/two/CHAPTER/Intro").search("p=123"),i.$digest(),expect(r).toEqual("before();after();"),expect(t.current).toEqual(void 0)})}),it("should allow configuring caseInsensitiveMatch on the route provider level",function(){module(function(e){e.caseInsensitiveMatch=!0,e.when("/Blank",{template:"blank"}),e.otherwise({template:"other"})}),inject(function(e,t,n){t.path("/bLaNk"),n.$digest(),expect(e.current.template).toBe("blank")})}),it("should allow overriding provider's caseInsensitiveMatch setting on the route level",function(){module(function(e){e.caseInsensitiveMatch=!0,e.when("/Blank",{template:"blank",caseInsensitiveMatch:!1}),e.otherwise({template:"other"})}),inject(function(e,t,n){t.path("/bLaNk"),n.$digest(),expect(e.current.template).toBe("other")})}),it("should not change route when location is canceled",function(){module(function(e){e.when("/somePath",{template:"some path"})}),inject(function(e,t,n,o){n.$on("$locationChangeStart",function(e){o.info("$locationChangeStart"),e.preventDefault()}),n.$on("$routeChangeSuccess",function(e){throw new Error("Should not get here")}),t.path("/somePath"),n.$digest(),expect(o.info.logs.shift()).toEqual(["$locationChangeStart"])})}),describe("should match a route that contains special chars in the path",function(){beforeEach(module(function(e){e.when("/$test.23/foo*(bar)/:baz",{templateUrl:"test.html"})})),it("matches the full path",inject(function(e,t,n){t.path("/test"),n.$digest(),expect(e.current).toBeUndefined()})),it("matches literal .",inject(function(e,t,n){t.path("/$testX23/foo*(bar)/222"),n.$digest(),expect(e.current).toBeUndefined()})),it("matches literal *",inject(function(e,t,n){t.path("/$test.23/foooo(bar)/222"),n.$digest(),expect(e.current).toBeUndefined()})),it("treats backslashes normally",inject(function(e,t,n){t.path("/$test.23/foo*\\(bar)/222"),n.$digest(),expect(e.current).toBeUndefined()})),it("matches a URL with special chars",inject(function(e,t,n){t.path("/$test.23/foo*(bar)/~!@#$%^&*()_+=-`"),n.$digest(),expect(e.current).toBeDefined()})),it("should use route params inherited from prototype chain",function(){function e(){}e.prototype.templateUrl="foo.html",module(function(t){t.when("/foo",new e)}),inject(function(e,t,n){t.path("/foo"),n.$digest(),expect(e.current.templateUrl).toBe("foo.html")})})}),describe("should match a route that contains optional params in the path",function(){beforeEach(module(function(e){e.when("/test/:opt?/:baz/edit",{templateUrl:"test.html"})})),it("matches a URL with optional params",inject(function(e,t,n){t.path("/test/optValue/bazValue/edit"),n.$digest(),expect(e.current).toBeDefined()})),it("matches a URL without optional param",inject(function(e,t,n){t.path("/test//bazValue/edit"),n.$digest(),expect(e.current).toBeDefined()})),it("not match a URL with a required param",inject(function(e,t,n){t.path("///edit"),n.$digest(),expect(e.current).not.toBeDefined()}))}),it("should change route even when only search param changes",function(){module(function(e){e.when("/test",{templateUrl:"test.html"})}),inject(function(e,t,n){var o=jasmine.createSpy("onRouteChange");n.$on("$routeChangeStart",o),t.path("/test"),n.$digest(),o.calls.reset(),t.search({any:!0}),n.$digest(),expect(o).toHaveBeenCalled()})}),it("should allow routes to be defined with just templates without controllers",function(){module(function(e){e.when("/foo",{templateUrl:"foo.html"})}),inject(function(e,t,n){var o=jasmine.createSpy("onChange");
n.$on("$routeChangeStart",o),expect(e.current).toBeUndefined(),expect(o).not.toHaveBeenCalled(),t.path("/foo"),n.$digest(),expect(e.current.templateUrl).toEqual("foo.html"),expect(e.current.controller).toBeUndefined(),expect(o).toHaveBeenCalled()})}),it("should chain whens and otherwise",function(){module(function(e){e.when("/foo",{templateUrl:"foo.html"}).otherwise({templateUrl:"bar.html"}).when("/baz",{templateUrl:"baz.html"})}),inject(function(e,t,n){n.$digest(),expect(e.current.templateUrl).toBe("bar.html"),t.url("/baz"),n.$digest(),expect(e.current.templateUrl).toBe("baz.html")})}),it("should skip routes with incomplete params",function(){module(function(e){e.otherwise({template:"other"}).when("/pages/:page/:comment*",{template:"comment"}).when("/pages/:page",{template:"page"}).when("/pages",{template:"index"}).when("/foo/",{template:"foo"}).when("/foo/:bar",{template:"bar"}).when("/foo/:bar*/:baz",{template:"baz"})}),inject(function(e,t,n){t.url("/pages/"),n.$digest(),expect(e.current.template).toBe("index"),t.url("/pages/page/"),n.$digest(),expect(e.current.template).toBe("page"),t.url("/pages/page/1/"),n.$digest(),expect(e.current.template).toBe("comment"),t.url("/foo/"),n.$digest(),expect(e.current.template).toBe("foo"),t.url("/foo/bar/"),n.$digest(),expect(e.current.template).toBe("bar"),t.url("/foo/bar/baz/"),n.$digest(),expect(e.current.template).toBe("baz"),t.url("/something/"),n.$digest(),expect(e.current.template).toBe("other")})}),describe("otherwise",function(){it('should handle unknown routes with "otherwise" route definition',function(){function e(){}module(function(t){t.when("/foo",{templateUrl:"foo.html"}),t.otherwise({templateUrl:"404.html",controller:e})}),inject(function(t,n,o){var r=jasmine.createSpy("onChange");o.$on("$routeChangeStart",r),expect(t.current).toBeUndefined(),expect(r).not.toHaveBeenCalled(),n.path("/unknownRoute"),o.$digest(),expect(t.current.templateUrl).toBe("404.html"),expect(t.current.controller).toBe(e),expect(r).toHaveBeenCalled(),r.calls.reset(),n.path("/foo"),o.$digest(),expect(t.current.templateUrl).toEqual("foo.html"),expect(t.current.controller).toBeUndefined(),expect(r).toHaveBeenCalled()})}),it("should update $route.current and $route.next when default route is matched",function(){module(function(e){e.when("/foo",{templateUrl:"foo.html"}),e.otherwise({templateUrl:"404.html"})}),inject(function(e,t,n){var o,r,a=jasmine.createSpy("onChange").and.callFake(function(t,n){o=e.current,r=n});n.$on("$routeChangeStart",a),expect(e.current).toBeUndefined(),expect(a).not.toHaveBeenCalled(),t.path("/unknownRoute"),n.$digest(),expect(o).toBeUndefined(),expect(r.templateUrl).toBe("404.html"),expect(e.current.templateUrl).toBe("404.html"),expect(a).toHaveBeenCalled(),a.calls.reset(),t.path("/foo"),n.$digest(),expect(o.templateUrl).toBe("404.html"),expect(r.templateUrl).toBe("foo.html"),expect(e.current.templateUrl).toEqual("foo.html"),expect(a).toHaveBeenCalled(),a.calls.reset(),t.path("/anotherUnknownRoute"),n.$digest(),expect(o.templateUrl).toBe("foo.html"),expect(r.templateUrl).toBe("404.html"),expect(e.current.templateUrl).toEqual("404.html"),expect(a).toHaveBeenCalled()})}),it("should interpret a string as a redirect route",function(){module(function(e){e.when("/foo",{templateUrl:"foo.html"}),e.when("/baz",{templateUrl:"baz.html"}),e.otherwise("/foo")}),inject(function(e,t,n){t.path("/unknownRoute"),n.$digest(),expect(t.path()).toBe("/foo"),expect(e.current.templateUrl).toBe("foo.html")})})}),describe("events",function(){it("should not fire $routeChangeStart/Success during bootstrap (if no route)",function(){var e=jasmine.createSpy("route change");module(function(e){e.when("/one",{})}),inject(function(t,n,o){t.$on("$routeChangeStart",e),t.$on("$routeChangeSuccess",e),t.$digest(),expect(e).not.toHaveBeenCalled(),o.path("/no-route-here"),t.$digest(),expect(e).not.toHaveBeenCalled(),o.path("/one"),t.$digest(),expect(e).toHaveBeenCalled()})}),it("should fire $routeChangeStart and resolve promises",function(){var e,t;module(function(n,o){n.factory("b",function(e){return t=e.defer(),t.promise}),o.when("/path",{templateUrl:"foo.html",resolve:{a:["$q",function(t){return e=t.defer(),e.promise}],b:"b"}})}),inject(function(n,o,r,a){var i="";a.expectGET("foo.html").respond("FOO"),n.path("/path"),r.$digest(),expect(i).toEqual(""),a.flush(),expect(i).toEqual(""),e.resolve(),r.$digest(),expect(i).toEqual(""),t.resolve(),r.$digest(),expect(o.current.locals.$template).toEqual("FOO")})}),it("should fire $routeChangeError event on resolution error",function(){var e;module(function(t,n){n.when("/path",{template:"foo",resolve:{a:function(t){return e=t.defer(),e.promise}}})}),inject(function(t,n,o){var r="";o.$on("$routeChangeStart",function(){r+="before();"}),o.$on("$routeChangeError",function(e,t,n,o){r+="failed("+o+");"}),t.path("/path"),o.$digest(),expect(r).toEqual("before();"),e.reject("MyError"),o.$digest(),expect(r).toEqual("before();failed(MyError);")})}),it("should fetch templates",function(){module(function(e){e.when("/r1",{templateUrl:"r1.html"}).when("/r2",{templateUrl:"r2.html"})}),inject(function(e,t,n,o){var r="";o.$on("$routeChangeStart",function(e,t){r+="$before("+t.templateUrl+");"}),o.$on("$routeChangeSuccess",function(e,t){r+="$after("+t.templateUrl+");"}),t.expectGET("r1.html").respond("R1"),t.expectGET("r2.html").respond("R2"),n.path("/r1"),o.$digest(),expect(r).toBe("$before(r1.html);"),n.path("/r2"),o.$digest(),expect(r).toBe("$before(r1.html);$before(r2.html);"),t.flush(),expect(r).toBe("$before(r1.html);$before(r2.html);$after(r2.html);"),expect(r).not.toContain("$after(r1.html);")})}),it("should NOT load cross domain templates by default",function(){module(function(e){e.when("/foo",{templateUrl:"http://example.com/foo.html"})}),inject(function(e,t,n){var o=jasmine.createSpy("onError"),r=jasmine.createSpy("onSuccess");n.$on("$routeChangeError",o),n.$on("$routeChangeSuccess",r),t.path("/foo"),n.$digest(),expect(r).not.toHaveBeenCalled(),expect(o).toHaveBeenCalled(),expect(o.calls.mostRecent().args[3]).toEqualMinErr("$sce","insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: http://example.com/foo.html")})}),it("should load cross domain templates that are trusted",function(){module(function(e,t){e.when("/foo",{templateUrl:"http://example.com/foo.html"}),t.resourceUrlWhitelist([/^http:\/\/example\.com\/foo\.html$/])}),inject(function(t,n,o){e.whenGET("http://example.com/foo.html").respond("FOO BODY"),n.path("/foo"),o.$digest(),e.flush(),expect(t.current.locals.$template).toEqual("FOO BODY")})}),it("should not update $routeParams until $routeChangeSuccess",function(){module(function(e){e.when("/r1/:id",{templateUrl:"r1.html"}).when("/r2/:id",{templateUrl:"r2.html"})}),inject(function(e,n,o,r,a){var i="";r.$on("$routeChangeStart",function(e,n){i+="$before"+t.toJson(a)+";"}),r.$on("$routeChangeSuccess",function(e,n){i+="$after"+t.toJson(a)+";"}),n.whenGET("r1.html").respond("R1"),n.whenGET("r2.html").respond("R2"),o.path("/r1/1"),r.$digest(),expect(i).toBe("$before{};"),n.flush(),expect(i).toBe('$before{};$after{"id":"1"};'),i="",o.path("/r2/2"),r.$digest(),expect(i).toBe('$before{"id":"1"};'),n.flush(),expect(i).toBe('$before{"id":"1"};$after{"id":"2"};')})}),it("should drop in progress route change when new route change occurs",function(){module(function(e){e.when("/r1",{templateUrl:"r1.html"}).when("/r2",{templateUrl:"r2.html"})}),inject(function(e,t,n,o){var r="";o.$on("$routeChangeStart",function(e,t){r+="$before("+t.templateUrl+");"}),o.$on("$routeChangeSuccess",function(e,t){r+="$after("+t.templateUrl+");"}),t.expectGET("r1.html").respond("R1"),t.expectGET("r2.html").respond("R2"),n.path("/r1"),o.$digest(),expect(r).toBe("$before(r1.html);"),n.path("/r2"),o.$digest(),expect(r).toBe("$before(r1.html);$before(r2.html);"),t.flush(),expect(r).toBe("$before(r1.html);$before(r2.html);$after(r2.html);"),expect(r).not.toContain("$after(r1.html);")})}),it("should throw an error when a template is not found",function(){module(function(e,t){t.mode("log"),e.when("/r1",{templateUrl:"r1.html"}).when("/r2",{templateUrl:"r2.html"}).when("/r3",{templateUrl:"r3.html"})}),inject(function(e,t,n,o,r){t.expectGET("r1.html").respond(404,"R1"),n.path("/r1"),o.$digest(),t.flush(),expect(r.errors.pop()).toEqualMinErr("$templateRequest","tpload","Failed to load template: r1.html"),t.expectGET("r2.html").respond(""),n.path("/r2"),o.$digest(),t.flush(),expect(r.errors.length).toBe(0),t.expectGET("r3.html").respond("abc"),n.path("/r3"),o.$digest(),t.flush(),expect(r.errors.length).toBe(0)})}),it("should catch local factory errors",function(){var e=new Error("MyError");module(function(t){t.when("/locals",{resolve:{a:function(t){throw e}}})}),inject(function(t,n,o){spyOn(o,"$broadcast").and.callThrough(),t.path("/locals"),o.$digest(),expect(o.$broadcast).toHaveBeenCalledWith("$routeChangeError",jasmine.any(Object),void 0,e)})})}),it("should match route with and without trailing slash",function(){module(function(e){e.when("/foo",{templateUrl:"foo.html"}),e.when("/bar/",{templateUrl:"bar.html"})}),inject(function(e,t,n){t.path("/foo"),n.$digest(),expect(t.path()).toBe("/foo"),expect(e.current.templateUrl).toBe("foo.html"),t.path("/foo/"),n.$digest(),expect(t.path()).toBe("/foo"),expect(e.current.templateUrl).toBe("foo.html"),t.path("/bar"),n.$digest(),expect(t.path()).toBe("/bar/"),expect(e.current.templateUrl).toBe("bar.html"),t.path("/bar/"),n.$digest(),expect(t.path()).toBe("/bar/"),expect(e.current.templateUrl).toBe("bar.html")})}),it("should not get affected by modifying the route definition object after route registration",function(){module(function(e){var t={};t.templateUrl="foo.html",e.when("/foo",t),t.templateUrl="bar.html",e.when("/bar",t)}),inject(function(e,t,n){e.path("/bar"),t.$digest(),expect(e.path()).toBe("/bar"),expect(n.current.templateUrl).toBe("bar.html"),e.path("/foo"),t.$digest(),expect(e.path()).toBe("/foo"),expect(n.current.templateUrl).toBe("foo.html")})}),it("should use the property values of the passed in route definition object directly",function(){var e;module(function(t){e=t}),inject(function(t,n,o,r){var a=r.trustAsResourceUrl("foo.html");e.when("/foo",{templateUrl:a}),t.path("/foo"),n.$digest(),expect(t.path()).toBe("/foo"),expect(o.current.templateUrl).toBe(a)})}),it("should support custom `$sce` implementations",function(){function e(e){var t=this;this._val=e,this.getVal=function(){return this!==t?null:this._val}}var t;module(function(n,o){t=o,n.decorator("$sce",function(t){function n(e){return e.getVal?e.getVal():e}return t.trustAsResourceUrl=function(t){return new e(t)},t.getTrustedResourceUrl=function(e){return n(e)},t.valueOf=function(e){return n(e)},t})}),inject(function(e,n,o,r){t.when("/foo",{templateUrl:r.trustAsResourceUrl("foo.html")}),e.path("/foo"),n.$digest(),expect(e.path()).toBe("/foo"),expect(r.valueOf(o.current.templateUrl)).toBe("foo.html")})}),describe("redirection",function(){describe("via `redirectTo`",function(){it("should support redirection via redirectTo property by updating $location",function(){module(function(e){e.when("/",{redirectTo:"/foo"}),e.when("/foo",{templateUrl:"foo.html"}),e.when("/bar",{templateUrl:"bar.html"}),e.when("/baz",{redirectTo:"/bar"}),e.otherwise({templateUrl:"404.html"})}),inject(function(e,t,n){var o=jasmine.createSpy("onChange");n.$on("$routeChangeStart",o),expect(e.current).toBeUndefined(),expect(o).not.toHaveBeenCalled(),t.path("/"),n.$digest(),expect(t.path()).toBe("/foo"),expect(e.current.templateUrl).toBe("foo.html"),expect(o).toHaveBeenCalledTimes(2),o.calls.reset(),t.path("/baz"),n.$digest(),expect(t.path()).toBe("/bar"),expect(e.current.templateUrl).toBe("bar.html"),expect(o).toHaveBeenCalledTimes(2)})}),it("should interpolate route vars in the redirected path from original path",function(){module(function(e){e.when("/foo/:id/foo/:subid/:extraId",{redirectTo:"/bar/:id/:subid/23"}),e.when("/bar/:id/:subid/:subsubid",{templateUrl:"bar.html"}),e.when("/baz/:id/:path*",{redirectTo:"/path/:path/:id"}),e.when("/path/:path*/:id",{templateUrl:"foo.html"})}),inject(function(e,t,n){t.path("/foo/id1/foo/subid3/gah"),n.$digest(),expect(t.path()).toEqual("/bar/id1/subid3/23"),expect(t.search()).toEqual({extraId:"gah"}),expect(e.current.templateUrl).toEqual("bar.html"),t.path("/baz/1/foovalue/barvalue"),n.$digest(),expect(t.path()).toEqual("/path/foovalue/barvalue/1"),expect(e.current.templateUrl).toEqual("foo.html")})}),it("should interpolate route vars in the redirected path from original search",function(){module(function(e){e.when("/bar/:id/:subid/:subsubid",{templateUrl:"bar.html"}),e.when("/foo/:id/:extra",{redirectTo:"/bar/:id/:subid/99"})}),inject(function(e,t,n){t.path("/foo/id3/eId").search("subid=sid1&appended=true"),n.$digest(),expect(t.path()).toEqual("/bar/id3/sid1/99"),expect(t.search()).toEqual({appended:"true",extra:"eId"}),expect(e.current.templateUrl).toEqual("bar.html")})}),it("should properly process route params which are both eager and optional",function(){module(function(e){e.when("/foo/:param1*?/:param2",{templateUrl:"foo.html"})}),inject(function(e,t,n){e.path("/foo/bar1/bar2/bar3/baz"),t.$digest(),expect(e.path()).toEqual("/foo/bar1/bar2/bar3/baz"),expect(n.current.params.param1).toEqual("bar1/bar2/bar3"),expect(n.current.params.param2).toEqual("baz"),expect(n.current.templateUrl).toEqual("foo.html"),e.path("/foo/baz"),t.$digest(),expect(e.path()).toEqual("/foo/baz"),expect(n.current.params.param1).toEqual(void 0),expect(n.current.params.param2).toEqual("baz"),expect(n.current.templateUrl).toEqual("foo.html")})}),it("should properly interpolate optional and eager route vars when redirecting from path with trailing slash",function(){module(function(e){e.when("/foo/:id?/:subid?",{templateUrl:"foo.html"}),e.when("/bar/:id*/:subid",{templateUrl:"bar.html"})}),inject(function(e,t,n){e.path("/foo/id1/subid2/"),t.$digest(),expect(e.path()).toEqual("/foo/id1/subid2"),expect(n.current.templateUrl).toEqual("foo.html"),e.path("/bar/id1/extra/subid2/"),t.$digest(),expect(e.path()).toEqual("/bar/id1/extra/subid2"),expect(n.current.templateUrl).toEqual("bar.html")})}),it("should allow custom redirectTo function to be used",function(){function e(e,t,n){return expect(e).toEqual({id:"id3"}),expect(t).toEqual("/foo/id3"),expect(n).toEqual({subid:"sid1",appended:"true"}),"/custom"}module(function(t){t.when("/foo/:id",{redirectTo:e})}),inject(function(e,t,n){t.path("/foo/id3").search("subid=sid1&appended=true"),n.$digest(),expect(t.path()).toEqual("/custom")})}),it("should broadcast `$routeChangeError` when redirectTo throws",function(){var e=new Error("Test");module(function(t){t.when("/foo",{redirectTo:function(){throw e}})}),inject(function(t,n,o,r){spyOn(o,"$broadcast").and.callThrough(),n.path("/foo"),o.$digest();var a=o.$broadcast.calls.mostRecent().args;expect(a[0]).toBe("$routeChangeError"),expect(a[3]).toBe(e)})}),it("should replace the url when redirecting",function(){module(function(e){e.when("/bar/:id",{templateUrl:"bar.html"}),e.when("/foo/:id/:extra",{redirectTo:"/bar/:id"})}),inject(function(e,t,n,o){var r=spyOnlyCallsWithArgs(e,"url").and.callThrough();n.path("/foo/id3/eId"),o.$digest(),expect(n.path()).toEqual("/bar/id3"),expect(r.calls.mostRecent().args).toEqual(["http://server/#!/bar/id3?extra=eId",!0,null])})}),it("should not process route bits",function(){var e=jasmine.createSpy("first controller spy"),t=jasmine.createSpy("first template spy").and.returnValue("redirected view"),n=jasmine.createSpy("first resolve spy"),o=jasmine.createSpy("second controller spy"),r=jasmine.createSpy("second template spy").and.returnValue("redirected view"),a=jasmine.createSpy("second resolve spy");module(function(i){i.when("/redirect",{template:t,redirectTo:"/redirected",resolve:{value:n},controller:e}),i.when("/redirected",{template:r,resolve:{value:a},controller:o})}),inject(function(i,s,l,c){var u=c("<div><ng-view></ng-view></div>")(l);s.path("/redirect"),l.$digest(),expect(e).not.toHaveBeenCalled(),expect(t).not.toHaveBeenCalled(),expect(n).not.toHaveBeenCalled(),expect(o).toHaveBeenCalled(),expect(r).toHaveBeenCalled(),expect(a).toHaveBeenCalled(),dealoc(u)})}),it("should not redirect transition if `redirectTo` returns `undefined`",function(){var e=jasmine.createSpy("first controller spy"),t=jasmine.createSpy("first template spy").and.returnValue("redirected view");module(function(n){n.when("/redirect/to/undefined",{template:t,redirectTo:function(){},controller:e})}),inject(function(n,o,r,a){var i=a("<div><ng-view></ng-view></div>")(r);o.path("/redirect/to/undefined"),r.$digest(),expect(e).toHaveBeenCalled(),expect(t).toHaveBeenCalled(),expect(o.path()).toEqual("/redirect/to/undefined"),dealoc(i)})})}),describe("via `resolveRedirectTo`",function(){function e(){return{fooResolveSpy:jasmine.createSpy("fooResolve"),fooTemplateSpy:jasmine.createSpy("fooTemplate").and.returnValue("Foo"),fooControllerSpy:jasmine.createSpy("fooController"),barResolveSpy:jasmine.createSpy("barResolve"),barTemplateSpy:jasmine.createSpy("barTemplate").and.returnValue("Bar"),barControllerSpy:jasmine.createSpy("barController"),bazResolveSpy:jasmine.createSpy("bazResolve"),bazTemplateSpy:jasmine.createSpy("bazTemplate").and.returnValue("Baz"),bazControllerSpy:jasmine.createSpy("bazController")}}function t(e,t,n){e.when("/foo",{resolveRedirectTo:n,resolve:{_:t.fooResolveSpy},template:t.fooTemplateSpy,controller:t.fooControllerSpy}).when("/bar",{resolve:{_:t.barResolveSpy},template:t.barTemplateSpy,controller:t.barControllerSpy}).when("/baz",{resolve:{_:t.bazResolveSpy},template:t.bazTemplateSpy,controller:t.bazControllerSpy})}var n,o,r,a;beforeEach(module(function(){return function(e,t,i,s){n=e,o=t,r=i,a=s}})),it("should be ignored if `redirectTo` is also present",function(){var e,t=function(){return e},n=jasmine.createSpy("resolveRedirectTo").and.returnValue("/bar"),i=jasmine.createSpy("redirectTo").and.callFake(t),s=jasmine.createSpy("template").and.returnValue("Foo");module(function(e){e.when("/foo",{resolveRedirectTo:n,redirectTo:i,template:s}).when("/bar",{template:"Bar"}).when("/baz",{template:"Baz"})}),inject(function(){e="/baz",o.path("/foo"),r.$digest(),expect(o.path()).toBe("/baz"),expect(a.current.template).toBe("Baz"),expect(n).not.toHaveBeenCalled(),expect(i).toHaveBeenCalled(),expect(s).not.toHaveBeenCalled(),i.calls.reset(),e=void 0,o.path("/foo"),r.$digest(),expect(o.path()).toBe("/foo"),expect(a.current.template).toBe(s),expect(n).not.toHaveBeenCalled(),expect(i).toHaveBeenCalled(),expect(s).toHaveBeenCalled()})}),it("should redirect to the returned url",function(){module(function(e){e.when("/foo",{resolveRedirectTo:function(){return"/bar?baz=qux"}}).when("/bar",{template:"Bar"})}),inject(function(){o.path("/foo"),r.$digest(),expect(o.path()).toBe("/bar"),expect(o.search()).toEqual({baz:"qux"}),expect(a.current.template).toBe("Bar")})}),it("should support returning a promise",function(){module(function(e){e.when("/foo",{resolveRedirectTo:function(e){return e.resolve("/bar")}}).when("/bar",{template:"Bar"})}),inject(function(){o.path("/foo"),r.$digest(),expect(o.path()).toBe("/bar"),expect(a.current.template).toBe("Bar")})}),it("should support dependency injection",function(){module(function(e,t){e.value("nextRoute","/bar"),t.when("/foo",{resolveRedirectTo:function(e){return e}})}),inject(function(){o.path("/foo"),r.$digest(),expect(o.path()).toBe("/bar")})}),it("should have access to the current routeParams via `$route.current.params`",function(){module(function(e){e.when("/foo/:bar/baz/:qux",{resolveRedirectTo:function(e){return expect(e.current.params).toEqual(jasmine.objectContaining({bar:"1",qux:"2"})),"/passed"}})}),inject(function(){o.path("/foo/1/baz/2").search({bar:"qux"}),r.$digest(),expect(o.path()).toBe("/passed")})}),it("should not process route bits until the promise is resolved",function(){var a,i=e(),s=!1;module(function(e){t(e,i,function(e){return s=!0,a=e.defer(),a.promise})}),inject(function(){var e=n("<div><ng-view></ng-view></div>")(r);o.path("/foo"),r.$digest(),expect(o.path()).toBe("/foo"),expect(s).toBe(!0),expect(i.fooResolveSpy).not.toHaveBeenCalled(),expect(i.fooTemplateSpy).not.toHaveBeenCalled(),expect(i.fooControllerSpy).not.toHaveBeenCalled(),expect(i.barResolveSpy).not.toHaveBeenCalled(),expect(i.barTemplateSpy).not.toHaveBeenCalled(),expect(i.barControllerSpy).not.toHaveBeenCalled(),a.resolve("/bar"),r.$digest(),expect(o.path()).toBe("/bar"),expect(i.fooResolveSpy).not.toHaveBeenCalled(),expect(i.fooTemplateSpy).not.toHaveBeenCalled(),expect(i.fooControllerSpy).not.toHaveBeenCalled(),expect(i.barResolveSpy).toHaveBeenCalled(),expect(i.barTemplateSpy).toHaveBeenCalled(),expect(i.barControllerSpy).toHaveBeenCalled(),dealoc(e)})}),it("should not redirect if `undefined` is returned",function(){var a=e(),i=!1;module(function(e){t(e,a,function(){return void(i=!0)})}),inject(function(){var e=n("<div><ng-view></ng-view></div>")(r);o.path("/foo"),r.$digest(),expect(o.path()).toBe("/foo"),expect(i).toBe(!0),expect(a.fooResolveSpy).toHaveBeenCalled(),expect(a.fooTemplateSpy).toHaveBeenCalled(),expect(a.fooControllerSpy).toHaveBeenCalled(),expect(a.barResolveSpy).not.toHaveBeenCalled(),expect(a.barTemplateSpy).not.toHaveBeenCalled(),expect(a.barControllerSpy).not.toHaveBeenCalled(),dealoc(e)})}),it("should not redirect if the returned promise resolves to `undefined`",function(){var a=e(),i=!1;module(function(e){t(e,a,function(e){return i=!0,e.resolve(void 0)})}),inject(function(){var e=n("<div><ng-view></ng-view></div>")(r);o.path("/foo"),r.$digest(),expect(o.path()).toBe("/foo"),expect(i).toBe(!0),expect(a.fooResolveSpy).toHaveBeenCalled(),expect(a.fooTemplateSpy).toHaveBeenCalled(),expect(a.fooControllerSpy).toHaveBeenCalled(),expect(a.barResolveSpy).not.toHaveBeenCalled(),expect(a.barTemplateSpy).not.toHaveBeenCalled(),expect(a.barControllerSpy).not.toHaveBeenCalled(),dealoc(e)})}),it("should not redirect if the returned promise gets rejected",function(){var a=e(),i=!1;module(function(e){t(e,a,function(e){return i=!0,e.reject("")})}),inject(function(){spyOn(r,"$broadcast").and.callThrough();var e=n("<div><ng-view></ng-view></div>")(r);o.path("/foo"),r.$digest(),expect(o.path()).toBe("/foo"),expect(i).toBe(!0),expect(a.fooResolveSpy).not.toHaveBeenCalled(),expect(a.fooTemplateSpy).not.toHaveBeenCalled(),expect(a.fooControllerSpy).not.toHaveBeenCalled(),expect(a.barResolveSpy).not.toHaveBeenCalled(),expect(a.barTemplateSpy).not.toHaveBeenCalled(),expect(a.barControllerSpy).not.toHaveBeenCalled();var t=r.$broadcast.calls.mostRecent().args;expect(t[0]).toBe("$routeChangeError"),dealoc(e)})}),it("should ignore previous redirection if newer transition happened",function(){var a,i=e(),s=!1;module(function(e){t(e,i,function(e){return s=!0,a=e.defer(),a.promise})}),inject(function(){spyOn(o,"url").and.callThrough();var e=n("<div><ng-view></ng-view></div>")(r);o.path("/foo"),r.$digest(),expect(o.path()).toBe("/foo"),expect(s).toBe(!0),expect(i.fooResolveSpy).not.toHaveBeenCalled(),expect(i.fooTemplateSpy).not.toHaveBeenCalled(),expect(i.fooControllerSpy).not.toHaveBeenCalled(),expect(i.barResolveSpy).not.toHaveBeenCalled(),expect(i.barTemplateSpy).not.toHaveBeenCalled(),expect(i.barControllerSpy).not.toHaveBeenCalled(),expect(i.bazResolveSpy).not.toHaveBeenCalled(),expect(i.bazTemplateSpy).not.toHaveBeenCalled(),expect(i.bazControllerSpy).not.toHaveBeenCalled(),o.path("/baz"),r.$digest(),expect(o.path()).toBe("/baz"),expect(i.fooResolveSpy).not.toHaveBeenCalled(),expect(i.fooTemplateSpy).not.toHaveBeenCalled(),expect(i.fooControllerSpy).not.toHaveBeenCalled(),expect(i.barResolveSpy).not.toHaveBeenCalled(),expect(i.barTemplateSpy).not.toHaveBeenCalled(),expect(i.barControllerSpy).not.toHaveBeenCalled(),expect(i.bazResolveSpy).toHaveBeenCalledOnce(),expect(i.bazTemplateSpy).toHaveBeenCalledOnce(),expect(i.bazControllerSpy).toHaveBeenCalledOnce(),a.resolve(),r.$digest(),expect(o.path()).toBe("/baz"),expect(i.fooResolveSpy).not.toHaveBeenCalled(),expect(i.fooTemplateSpy).not.toHaveBeenCalled(),expect(i.fooControllerSpy).not.toHaveBeenCalled(),expect(i.barResolveSpy).not.toHaveBeenCalled(),expect(i.barTemplateSpy).not.toHaveBeenCalled(),expect(i.barControllerSpy).not.toHaveBeenCalled(),expect(i.bazResolveSpy).toHaveBeenCalledOnce(),expect(i.bazTemplateSpy).toHaveBeenCalledOnce(),expect(i.bazControllerSpy).toHaveBeenCalledOnce(),dealoc(e)})})})}),describe("reloadOnUrl",function(){it("should reload when `reloadOnUrl` is true and `.url()` changes",function(){var e=jasmine.createSpy("routeChange");module(function(e){e.when("/path/:param",{})}),inject(function(t,n,o){n.$on("$routeChangeStart",e),t.path("/path/foo"),n.$digest(),expect(e).toHaveBeenCalledOnce(),expect(o).toEqual({param:"foo"}),e.calls.reset(),t.path("/path/bar"),n.$digest(),expect(e).toHaveBeenCalledOnce(),expect(o).toEqual({param:"bar"}),e.calls.reset(),t.search("foo","bar"),n.$digest(),expect(e).toHaveBeenCalledOnce(),expect(o).toEqual({param:"bar",foo:"bar"}),e.calls.reset(),t.hash("baz"),n.$digest(),expect(e).toHaveBeenCalledOnce(),expect(o).toEqual({param:"bar",foo:"bar"})})}),it("should reload when `reloadOnUrl` is false and URL maps to different route",function(){var e=jasmine.createSpy("routeChange"),t=jasmine.createSpy("routeUpdate");module(function(e){e.when("/path/:param",{reloadOnUrl:!1}).otherwise({})}),inject(function(n,o,r){o.$on("$routeChangeStart",e),o.$on("$routeChangeSuccess",e),o.$on("$routeUpdate",t),expect(e).not.toHaveBeenCalled(),n.path("/path/foo"),o.$digest(),expect(e).toHaveBeenCalledTimes(2),expect(t).not.toHaveBeenCalled(),expect(r).toEqual({param:"foo"}),e.calls.reset(),n.path("/other/path/bar"),o.$digest(),expect(e).toHaveBeenCalledTimes(2),expect(t).not.toHaveBeenCalled(),expect(r).toEqual({})})}),it("should not reload when `reloadOnUrl` is false and URL maps to the same route",function(){var e=jasmine.createSpy("routeChange"),t=jasmine.createSpy("routeUpdate");module(function(e){e.when("/path/:param",{reloadOnUrl:!1})}),inject(function(n,o,r){o.$on("$routeChangeStart",e),o.$on("$routeChangeSuccess",e),o.$on("$routeUpdate",t),expect(e).not.toHaveBeenCalled(),n.path("/path/foo"),o.$digest(),expect(e).toHaveBeenCalledTimes(2),expect(t).not.toHaveBeenCalled(),expect(r).toEqual({param:"foo"}),e.calls.reset(),n.path("/path/bar").search("foo","bar").hash("baz"),o.$digest(),expect(e).not.toHaveBeenCalled(),expect(t).toHaveBeenCalledOnce(),expect(r).toEqual({param:"bar",foo:"bar"})})}),it("should update `$routeParams` even when not reloading a route",function(){var e=jasmine.createSpy("routeChange");module(function(e){e.when("/path/:param",{reloadOnUrl:!1})}),inject(function(t,n,o){n.$on("$routeChangeStart",e),n.$on("$routeChangeSuccess",e),expect(e).not.toHaveBeenCalled(),t.path("/path/foo"),n.$digest(),expect(e).toHaveBeenCalledTimes(2),expect(o).toEqual({param:"foo"}),e.calls.reset(),t.path("/path/bar"),n.$digest(),expect(e).not.toHaveBeenCalled(),expect(o).toEqual({param:"bar"})})}),describe("with `$route.reload()`",function(){var e,t,o,r,a,i;beforeEach(module(function(e){e.when("/path/:param",{template:"",reloadOnUrl:!1,controller:function(e){e.debug("initialized")}})})),beforeEach(inject(function(s,l,c,u,d){e=l,t=c,o=u,r=d,a=jasmine.createSpy("routeChangeStart"),i=jasmine.createSpy("routeChangeSuccess"),o.$on("$routeChangeStart",a),o.$on("$routeChangeSuccess",i),n=s("<div><ng-view></ng-view></div>")(o)})),it("should reload the current route",function(){e.path("/path/foo"),o.$digest(),expect(e.path()).toBe("/path/foo"),expect(a).toHaveBeenCalledOnce(),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),a.calls.reset(),i.calls.reset(),t.reset(),r.reload(),o.$digest(),expect(e.path()).toBe("/path/foo"),expect(a).toHaveBeenCalledOnce(),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),t.reset()}),it("should support preventing a route reload",function(){e.path("/path/foo"),o.$digest(),expect(e.path()).toBe("/path/foo"),expect(a).toHaveBeenCalledOnce(),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),a.calls.reset(),i.calls.reset(),t.reset(),a.and.callFake(function(e){e.preventDefault()}),r.reload(),o.$digest(),expect(e.path()).toBe("/path/foo"),expect(a).toHaveBeenCalledOnce(),expect(i).not.toHaveBeenCalled(),expect(t.debug.logs).toEqual([])}),it("should reload the current route even if `reloadOnUrl` is disabled",inject(function(n){e.path("/path/foo"),o.$digest(),expect(a).toHaveBeenCalledOnce(),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),expect(n).toEqual({param:"foo"}),a.calls.reset(),i.calls.reset(),t.reset(),e.path("/path/bar"),o.$digest(),expect(a).not.toHaveBeenCalled(),expect(i).not.toHaveBeenCalled(),expect(t.debug.logs).toEqual([]),expect(n).toEqual({param:"bar"}),r.reload(),o.$digest(),expect(a).toHaveBeenCalledOnce(),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),expect(n).toEqual({param:"bar"}),t.reset()}))})}),describe("reloadOnSearch",function(){it("should not have any effect if `reloadOnUrl` is false",function(){var e=jasmine.createSpy("route reload");module(function(e){e.when("/foo",{reloadOnUrl:!1,reloadOnSearch:!0})}),inject(function(t,n,o,r){o.$on("$routeChangeStart",e),n.path("/foo"),o.$digest(),expect(e).toHaveBeenCalledOnce(),expect(r).toEqual({}),e.calls.reset(),n.search({foo:"bar"}),o.$digest(),expect(e).not.toHaveBeenCalled(),expect(r).toEqual({foo:"bar"}),n.hash("baz"),o.$digest(),expect(e).not.toHaveBeenCalled(),expect(r).toEqual({foo:"bar"})})}),it("should reload when `reloadOnSearch` is true and `.search()`/`.hash()` changes",function(){var e=jasmine.createSpy("route reload");module(function(e){e.when("/foo",{controller:t.noop})}),inject(function(t,n,o,r){o.$on("$routeChangeStart",e),n.path("/foo"),o.$digest(),expect(e).toHaveBeenCalledOnce(),expect(r).toEqual({}),e.calls.reset(),n.search({foo:"bar"}),o.$digest(),expect(e).toHaveBeenCalledOnce(),expect(r).toEqual({foo:"bar"}),e.calls.reset(),n.hash("baz"),o.$digest(),expect(e).toHaveBeenCalledOnce(),expect(r).toEqual({foo:"bar"})})}),it("should not reload when `reloadOnSearch` is false and `.search()`/`.hash()` changes",function(){var e=jasmine.createSpy("route change"),n=jasmine.createSpy("route update");module(function(e){e.when("/foo",{controller:t.noop,reloadOnSearch:!1})}),inject(function(t,o,r){r.$on("$routeChangeStart",e),r.$on("$routeChangeSuccess",e),r.$on("$routeUpdate",n),expect(e).not.toHaveBeenCalled(),o.path("/foo"),r.$digest(),expect(e).toHaveBeenCalledTimes(2),expect(n).not.toHaveBeenCalled(),e.calls.reset(),o.search({foo:"bar"}),r.$digest(),expect(e).not.toHaveBeenCalled(),expect(n).toHaveBeenCalledOnce(),n.calls.reset(),o.hash("baz"),r.$digest(),expect(e).not.toHaveBeenCalled(),expect(n).toHaveBeenCalled()})}),it("should reload when `reloadOnSearch` is false and url differs only in route path param",function(){var e=jasmine.createSpy("route change");module(function(e){e.when("/foo/:fooId",{controller:t.noop,reloadOnSearch:!1})}),inject(function(t,n,o){o.$on("$routeChangeStart",e),o.$on("$routeChangeSuccess",e),expect(e).not.toHaveBeenCalled(),n.path("/foo/aaa"),o.$digest(),expect(e).toHaveBeenCalledTimes(2),e.calls.reset(),n.path("/foo/bbb"),o.$digest(),expect(e).toHaveBeenCalledTimes(2),e.calls.reset(),n.search({foo:"bar"}).hash("baz"),o.$digest(),expect(e).not.toHaveBeenCalled()})}),it("should update params when `reloadOnSearch` is false and `.search()` changes",function(){var e=jasmine.createSpy("routeParamsWatcher");module(function(e){e.when("/foo",{controller:t.noop}),e.when("/bar/:barId",{controller:t.noop,reloadOnSearch:!1})}),inject(function(t,n,o,r){o.$watch(function(){return r},function(t){e(t)},!0),expect(e).not.toHaveBeenCalled(),n.path("/foo"),o.$digest(),expect(e).toHaveBeenCalledWith({}),e.calls.reset(),n.search({foo:"bar"}),o.$digest(),expect(e).toHaveBeenCalledWith({foo:"bar"}),e.calls.reset(),
n.path("/bar/123").search({}),o.$digest(),expect(e).toHaveBeenCalledWith({barId:"123"}),e.calls.reset(),n.search({foo:"bar"}),o.$digest(),expect(e).toHaveBeenCalledWith({barId:"123",foo:"bar"})})}),it("should allow using a function as a template",function(){function e(e){return t(e),expect(e).toEqual({id:"id3"}),"<h1>"+e.id+"</h1>"}var t=jasmine.createSpy("customTemplateWatcher");module(function(t){t.when("/bar/:id/:subid/:subsubid",{templateUrl:"bar.html"}),t.when("/foo/:id",{template:e})}),inject(function(e,n,o){n.path("/foo/id3"),o.$digest(),expect(t).toHaveBeenCalledWith({id:"id3"})})}),it("should allow using a function as a templateUrl",function(){function e(e){return t(e),expect(e).toEqual({id:"id3"}),"foo.html"}var t=jasmine.createSpy("customTemplateUrlWatcher");module(function(t){t.when("/bar/:id/:subid/:subsubid",{templateUrl:"bar.html"}),t.when("/foo/:id",{templateUrl:e})}),inject(function(e,n,o){n.path("/foo/id3"),o.$digest(),expect(t).toHaveBeenCalledWith({id:"id3"}),expect(e.current.loadedTemplateUrl).toEqual("foo.html")})}),describe("with `$route.reload()`",function(){var e,t,o,r,a,i;beforeEach(module(function(e){function t(e){e.debug("initialized")}e.when("/bar/:barId",{template:"",controller:t,reloadOnSearch:!1})})),beforeEach(inject(function(s,l,c,u,d){e=l,t=c,o=u,r=d,a=jasmine.createSpy("routeChangeStart"),i=jasmine.createSpy("routeChangeSuccess"),o.$on("$routeChangeStart",a),o.$on("$routeChangeSuccess",i),n=s("<div><div ng-view></div></div>")(o)})),it("should reload the current route",function(){e.path("/bar/123"),o.$digest(),expect(e.path()).toBe("/bar/123"),expect(a).toHaveBeenCalledOnce(),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),a.calls.reset(),i.calls.reset(),t.reset(),r.reload(),o.$digest(),expect(e.path()).toBe("/bar/123"),expect(a).toHaveBeenCalledOnce(),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),t.reset()}),it("should support preventing a route reload",function(){e.path("/bar/123"),o.$digest(),expect(e.path()).toBe("/bar/123"),expect(a).toHaveBeenCalledOnce(),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),a.calls.reset(),i.calls.reset(),t.reset(),a.and.callFake(function(e){e.preventDefault()}),r.reload(),o.$digest(),expect(e.path()).toBe("/bar/123"),expect(a).toHaveBeenCalledOnce(),expect(i).not.toHaveBeenCalled(),expect(t.debug.logs).toEqual([])}),it("should reload even if reloadOnSearch is false",inject(function(n){e.path("/bar/123"),o.$digest(),expect(n).toEqual({barId:"123"}),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),i.calls.reset(),t.reset(),e.search("a=b"),o.$digest(),expect(n).toEqual({barId:"123",a:"b"}),expect(i).not.toHaveBeenCalled(),expect(t.debug.logs).toEqual([]),i.calls.reset(),t.reset(),e.hash("c"),o.$digest(),expect(n).toEqual({barId:"123",a:"b"}),expect(i).not.toHaveBeenCalled(),expect(t.debug.logs).toEqual([]),r.reload(),o.$digest(),expect(n).toEqual({barId:"123",a:"b"}),expect(i).toHaveBeenCalledOnce(),expect(t.debug.logs).toEqual([["initialized"]]),t.reset()}))})}),describe("update",function(){it("should support single-parameter route updating",function(){var e=jasmine.createSpy("route change");module(function(e){e.when("/bar/:barId",{controller:t.noop})}),inject(function(t,n,o,r){r.$on("$routeChangeSuccess",e),o.path("/bar/1"),r.$digest(),e.calls.reset(),t.updateParams({barId:"2"}),r.$digest(),expect(n).toEqual({barId:"2"}),expect(e).toHaveBeenCalledOnce(),expect(o.path()).toEqual("/bar/2")})}),it("should support total multi-parameter route updating",function(){var e=jasmine.createSpy("route change");module(function(e){e.when("/bar/:barId/:fooId/:spamId/:eggId",{controller:t.noop})}),inject(function(t,n,o,r){r.$on("$routeChangeSuccess",e),o.path("/bar/1/2/3/4"),r.$digest(),e.calls.reset(),t.updateParams({barId:"5",fooId:"6",spamId:"7",eggId:"8"}),r.$digest(),expect(n).toEqual({barId:"5",fooId:"6",spamId:"7",eggId:"8"}),expect(e).toHaveBeenCalledOnce(),expect(o.path()).toEqual("/bar/5/6/7/8")})}),it("should support partial multi-parameter route updating",function(){var e=jasmine.createSpy("route change");module(function(e){e.when("/bar/:barId/:fooId/:spamId/:eggId",{controller:t.noop})}),inject(function(t,n,o,r){r.$on("$routeChangeSuccess",e),o.path("/bar/1/2/3/4"),r.$digest(),e.calls.reset(),t.updateParams({barId:"5",fooId:"6"}),r.$digest(),expect(n).toEqual({barId:"5",fooId:"6",spamId:"3",eggId:"4"}),expect(e).toHaveBeenCalledOnce(),expect(o.path()).toEqual("/bar/5/6/3/4")})}),it("should update query params when new properties are not in path",function(){var e=jasmine.createSpy("route change");module(function(e){e.when("/bar/:barId/:fooId/:spamId/",{controller:t.noop})}),inject(function(t,n,o,r){r.$on("$routeChangeSuccess",e),o.path("/bar/1/2/3"),o.search({initial:"true"}),r.$digest(),e.calls.reset(),t.updateParams({barId:"5",fooId:"6",eggId:"4"}),r.$digest(),expect(n).toEqual({barId:"5",fooId:"6",spamId:"3",eggId:"4",initial:"true"}),expect(e).toHaveBeenCalledOnce(),expect(o.path()).toEqual("/bar/5/6/3/"),expect(o.search()).toEqual({eggId:"4",initial:"true"})})}),it("should not update query params when an optional property was previously not in path",function(){var e=jasmine.createSpy("route change");module(function(e){e.when("/bar/:barId/:fooId/:spamId/:eggId?",{controller:t.noop})}),inject(function(t,n,o,r){r.$on("$routeChangeSuccess",e),o.path("/bar/1/2/3"),o.search({initial:"true"}),r.$digest(),e.calls.reset(),t.updateParams({barId:"5",fooId:"6",eggId:"4"}),r.$digest(),expect(n).toEqual({barId:"5",fooId:"6",spamId:"3",eggId:"4",initial:"true"}),expect(e).toHaveBeenCalledOnce(),expect(o.path()).toEqual("/bar/5/6/3/4"),expect(o.search()).toEqual({initial:"true"})})}),it("should complain if called without an existing route",inject(function(e){expect(function(){e.updateParams()}).toThrowMinErr("ngRoute","norout")}))}),describe("testability",function(){it("should wait for $resolve promises before calling callbacks",function(){var e;module(function(t){t.when("/path",{resolve:{a:function(t){return e=t.defer(),e.promise}}})}),inject(function(t,n,o,r){n.path("/path"),o.$digest();var a=jasmine.createSpy("callback");r.whenStable(a),expect(a).not.toHaveBeenCalled(),e.resolve(),t.defer.flush(),expect(a).toHaveBeenCalled()})}),it("should call callback after $resolve promises are rejected",function(){var e;module(function(t){t.when("/path",{resolve:{a:function(t){return e=t.defer(),e.promise}}})}),inject(function(t,n,o,r){n.path("/path"),o.$digest();var a=jasmine.createSpy("callback");r.whenStable(a),expect(a).not.toHaveBeenCalled(),e.reject(),t.defer.flush(),expect(a).toHaveBeenCalled()})}),it("should wait for resolveRedirectTo promises before calling callbacks",function(){var e;module(function(t){t.when("/path",{resolveRedirectTo:function(t){return e=t.defer(),e.promise}})}),inject(function(t,n,o,r){n.path("/path"),o.$digest();var a=jasmine.createSpy("callback");r.whenStable(a),expect(a).not.toHaveBeenCalled(),e.resolve(),t.defer.flush(),expect(a).toHaveBeenCalled()})}),it("should call callback after resolveRedirectTo promises are rejected",function(){var e;module(function(t){t.when("/path",{resolveRedirectTo:function(t){return e=t.defer(),e.promise}})}),inject(function(t,n,o,r){n.path("/path"),o.$digest();var a=jasmine.createSpy("callback");r.whenStable(a),expect(a).not.toHaveBeenCalled(),e.reject(),t.defer.flush(),expect(a).toHaveBeenCalled()})}),it("should wait for all route promises before calling callbacks",function(){var e={};module(function(t){function n(n,o){t.when(n,{resolveRedirectTo:function(t){var r=e[n]=t.defer();return r.promise.then(function(){return o})}})}n("/foo","/bar"),n("/bar","/baz"),n("/baz","/qux"),t.when("/qux",{resolve:{a:function(t){var n=e["/qux"]=t.defer();return n.promise}}})}),inject(function(t,n,o,r){n.path("/foo"),o.$digest();var a=jasmine.createSpy("callback");r.whenStable(a),expect(a).not.toHaveBeenCalled(),e["/foo"].resolve(),t.defer.flush(),expect(a).not.toHaveBeenCalled(),e["/bar"].resolve(),t.defer.flush(),expect(a).not.toHaveBeenCalled(),e["/baz"].resolve(),t.defer.flush(),expect(a).not.toHaveBeenCalled(),e["/qux"].resolve(),t.defer.flush(),expect(a).toHaveBeenCalled()})})})})}(window,window.angular);